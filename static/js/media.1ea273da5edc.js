!function(){"use strict";var e,t={9820:function(e,t,n){var a=n(2541),r=(n(2322),n(9268),n(9006),n(5090),n(5101),n(3080),n(2004),n(8407),n(6394),n(8288),n(5677),n(2129),n(4655),n(5466)),i=n(3613),o=n(8578);function l(){return r.createElement("div",{className:"player-container viewer-attachment-container"},r.createElement("div",{className:"player-container-inner"},r.createElement("span",null,r.createElement("span",null,r.createElement("i",{className:"material-icons"},"insert_drive_file")))))}var s=n(3074),u=n.n(s),c=n(8009),d=n.n(c),p=n(473),m=n(541),f=n(9722);function y(e){var t=null,n=e.split(".");if(n.length)switch(n=n[n.length-1]){case"webm":t="audio/webm";break;case"flac":t="audio/flac";break;case"wave":t="audio/wave";break;case"wav":t="audio/wav";break;case"ogg":case"ogg":t="audio/ogg";break;case"mp3":case"mpeg":t="audio/mpeg"}return t}var h=n(1283);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(u,e);var t,n,a,l,s=(a=u,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(a);if(l){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return S(this,e)});function u(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),t=s.call(this,e);var n=o.MediaPageStore.get("media-data");t.AudioPlayerData={},t.audioStartedPlaying=!1;var a=(0,p.formatInnerLink)(n.original_media_url,i.SiteContext._currentValue.url);t.videoSources=[{src:a,type:y(a)}],t.videoPoster=n.poster_url,t.videoPoster=t.videoPoster?t.videoPoster:n.thumbnail_url,t.videoPoster=t.videoPoster?(0,p.formatInnerLink)(t.videoPoster,i.SiteContext._currentValue.url):"",t.updatePlayerVolume=t.updatePlayerVolume.bind(w(t)),t.onAudioEnd=t.onAudioEnd.bind(w(t)),t.onAudioRestart=t.onAudioRestart.bind(w(t)),o.PageStore.on("switched_media_auto_play",t.onUpdateMediaAutoPlay.bind(w(t))),t.wrapperClick=t.wrapperClick.bind(w(t));var r=new f.MediaDurationInfo;return r.update(o.MediaPageStore.get("media-data").duration),t.durationISO8601=r.ISO8601(),t}return t=u,(n=[{key:"componentDidMount",value:function(){this.videoSources.length||h.warn("Audio DEBUG:","Audio file doesn't exist"),this.recommendedMedia=o.MediaPageStore.get("media-data").related_media.length?new f.PlayerRecommendedMedia(o.MediaPageStore.get("media-data").related_media,this.refs.AudioElem.parentNode,this.props.inEmbed):null,this.upNextLoaderView=!this.props.inEmbed&&o.MediaPageStore.get("media-data").related_media.length?new f.UpNextLoaderView(o.MediaPageStore.get("media-data").related_media[0]):null,document.hasFocus()||"visible"===document.visibilityState?this.initPlayerInstance():(this.initPlayerInstance=this.initPlayerInstance.bind(this),window.addEventListener("focus",this.initPlayerInstance),document.addEventListener("visibilitychange",this.initPlayerInstance))}},{key:"componentWillUnmount",value:function(){this.recommendedMedia&&(this.AudioPlayerData.instance.player.off("fullscreenchange",this.recommendedMedia.onResize),o.PageStore.removeListener("window_resize",this.recommendedMedia.onResize),o.VideoViewerStore.removeListener("changed_viewer_mode",this.recommendedMedia.onResize),this.recommendedMedia.destroy()),videojs(this.refs.AudioElem).dispose(),this.AudioPlayerData.instance=null,delete this.AudioPlayerData.instance}},{key:"initPlayerInstance",value:function(){window.removeEventListener("focus",this.initPlayerInstance),document.removeEventListener("visibilitychange",this.initPlayerInstance),this.refs.AudioElem.focus(),this.initPlayerInstance=null,setTimeout(function(){if(!this.AudioPlayerData.instance){var e=this.props.inEmbed?document.createElement("a"):null,t=this.props.inEmbed?document.createElement("a"):null;e&&(e.setAttribute("class","title-link"),e.setAttribute("href",o.MediaPageStore.get("media-data").url),e.setAttribute("title",o.MediaPageStore.get("media-data").title),e.setAttribute("target","_blank"),e.innerHTML=o.MediaPageStore.get("media-data").title),t&&(t.setAttribute("class","user-thumb-link"),t.setAttribute("href",o.MediaPageStore.get("media-data").author_profile),t.setAttribute("title",o.MediaPageStore.get("media-data").author_name),t.setAttribute("target","_blank"),t.innerHTML='<img src="'+o.MediaPageStore.get("media-author-thumbnail-url")+'" alt="" />');var n=null,a=null;!this.props.inEmbed&&o.MediaPageStore.get("playlist-id")?(n=o.MediaPageStore.get("playlist-next-media-url"),a=o.MediaPageStore.get("playlist-previous-media-url")):n=o.MediaPageStore.get("media-data").related_media.length&&!this.props.inEmbed?o.MediaPageStore.get("media-data").related_media[0].url:null,this.AudioPlayerData.instance=new(d())(this.refs.AudioElem,{sources:this.videoSources,poster:this.videoPoster,autoplay:!this.props.inEmbed,bigPlayButton:!0,controlBar:{fullscreen:!1,theaterMode:!1,next:!!n,previous:!!a},cornerLayers:{topLeft:e,topRight:this.upNextLoaderView?this.upNextLoaderView.html():null,bottomLeft:this.recommendedMedia?this.recommendedMedia.html():null,bottomRight:t}},{volume:o.VideoViewerStore.get("player-volume"),soundMuted:o.VideoViewerStore.get("player-sound-muted")},null,null,this.onAudioPlayerStateUpdate.bind(this),this.onClickNextButton.bind(this),this.onClickPreviousButton.bind(this)),this.upNextLoaderView&&(this.upNextLoaderView.setVideoJsPlayerElem(this.AudioPlayerData.instance.player.el_),this.onUpdateMediaAutoPlay()),this.refs.AudioElem.parentNode.focus(),this.AudioPlayerData.instance.player.one("play",function(){this.audioStartedPlaying=!0}.bind(this)),this.recommendedMedia&&(this.recommendedMedia.initWrappers(this.AudioPlayerData.instance.player.el_),this.AudioPlayerData.instance.player.one("pause",this.recommendedMedia.init),this.AudioPlayerData.instance.player.on("fullscreenchange",this.recommendedMedia.onResize),o.PageStore.on("window_resize",this.recommendedMedia.onResize),o.VideoViewerStore.on("changed_viewer_mode",this.recommendedMedia.onResize)),this.AudioPlayerData.instance.player.one("ended",this.onAudioEnd)}}.bind(this),50)}},{key:"initialDocumentFocus",value:function(){this.refs.AudioElem.parentNode&&(this.refs.AudioElem.parentNode.focus(),setTimeout(function(){this.AudioPlayerData.instance.player.play()}.bind(this),50)),window.removeEventListener("focus",this.initialDocumentFocus),this.initialDocumentFocus=null}},{key:"onClickNextButton",value:function(){var e;o.MediaPageStore.get("playlist-id")?null===(e=o.MediaPageStore.get("playlist-next-media-url"))&&(e=o.MediaPageStore.get("media-data").related_media[0].url):this.props.inEmbed||(e=o.MediaPageStore.get("media-data").related_media[0].url),window.location.href=e}},{key:"onClickPreviousButton",value:function(){var e;o.MediaPageStore.get("playlist-id")?null===(e=o.MediaPageStore.get("playlist-previous-media-url"))&&(e=o.MediaPageStore.get("media-data").related_media[0].url):this.props.inEmbed||(e=o.MediaPageStore.get("media-data").related_media[0].url),window.location.href=e}},{key:"onUpdateMediaAutoPlay",value:function(){this.upNextLoaderView&&(o.PageStore.get("media-auto-play")?this.upNextLoaderView.showTimerView(this.AudioPlayerData.instance.isEnded()):this.upNextLoaderView.hideTimerView())}},{key:"onAudioPlayerStateUpdate",value:function(e){this.updatePlayerVolume(e.volume,e.soundMuted)}},{key:"onAudioRestart",value:function(){this.recommendedMedia&&(this.recommendedMedia.updateDisplayType("inline"),this.AudioPlayerData.instance.player.one("pause",this.recommendedMedia.init),this.AudioPlayerData.instance.player.one("ended",this.onAudioEnd))}},{key:"onAudioEnd",value:function(){if(this.recommendedMedia&&(this.recommendedMedia.updateDisplayType("full"),this.AudioPlayerData.instance.player.one("playing",this.onAudioRestart)),!this.props.inEmbed&&o.MediaPageStore.get("playlist-id")){var e=document.querySelector(".video-player .more-media"),t=document.querySelector(".video-player .vjs-actions-anim");this.upNextLoaderView.cancelTimer();var n=o.MediaPageStore.get("playlist-next-media-url");return n&&(e&&(e.style.display="none"),t&&(t.style.display="none"),window.location.href=n),void this.upNextLoaderView.hideTimerView()}this.upNextLoaderView&&(o.PageStore.get("media-auto-play")?(this.upNextLoaderView.startTimer(),this.AudioPlayerData.instance.player.one("play",function(){this.upNextLoaderView.cancelTimer()}.bind(this))):this.upNextLoaderView.cancelTimer())}},{key:"updatePlayerVolume",value:function(e,t){o.VideoViewerStore.get("player-volume")!==e&&m.VideoViewerActions.set_player_volume(e),o.VideoViewerStore.get("player-sound-muted")!==t&&m.VideoViewerActions.set_player_sound_muted(t)}},{key:"wrapperClick",value:function(e){e.target.parentNode===this.refs.videoPlayerWrap&&(this.AudioPlayerData.instance.player.ended()||(!this.AudioPlayerData.instance.player.hasStarted_||this.AudioPlayerData.instance.player.paused()?this.AudioPlayerData.instance.player.play():this.AudioPlayerData.instance.player.pause()))}},{key:"render",value:function(){return r.createElement("div",{className:"player-container audio-player-container"},r.createElement("div",{className:"player-container-inner"},r.createElement("div",{className:"video-player",ref:"videoPlayerWrap",onClick:this.wrapperClick},r.createElement("audio",{tabIndex:"1",ref:"AudioElem",className:"video-js vjs-mediacms native-dimensions"}))))}}])&&v(t.prototype,n),u}(r.PureComponent);function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _(e){var t=(0,r.useContext)(i.SiteContext),n=p();n=(n=n||o.MediaPageStore.get("media-data").thumbnail_url)||"";var a,l,s=(a=(0,r.useState)(n),l=2,function(e){if(Array.isArray(e))return e}(a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(a,l)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(a,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=s[0],c=s[1];function d(){c(p())}function p(){var e=o.MediaPageStore.get("media-data"),n="string"==typeof e.poster_url?e.poster_url.trim():"";return""===n&&(n="string"==typeof e.thumbnail_url?e.thumbnail_url.trim():""),""===n&&(n="string"==typeof o.MediaPageStore.get("media-original-url")?o.MediaPageStore.get("media-original-url").trim():""),""===n?"#":t.url+"/"+n.replace(/^\//g,"")}return(0,r.useEffect)((function(){return o.MediaPageStore.on("loaded_image_data",d),function(){return o.MediaPageStore.removeListener("loaded_image_data",d)}}),[]),u?r.createElement("div",{className:"viewer-image-container"},r.createElement("img",{src:u,alt:o.MediaPageStore.get("media-data").title||null})):null}function k(){return r.createElement("div",{className:"player-container viewer-pdf-container"},r.createElement("div",{className:"player-container-inner"},r.createElement("span",null,r.createElement("span",null,r.createElement("i",{className:"material-icons"},"insert_drive_file")))))}E.defaultProps={inEmbed:!1},E.propTypes={inEmbed:u().bool},n(3233),n(3296),n(288),n(4458),n(3675),n(9751);var C=n(9905),A=n(8727),N=n(1283);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?R(e):t}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(u,e);var t,n,a,l,s=(a=u,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=L(a);if(l){var n=L(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return V(this,e)});function u(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).state={displayPlayer:!1},t.videoSources=[],function(e){switch(e){case"running":o.MediaPageStore.set("media-load-error-type","encodingRunning"),o.MediaPageStore.set("media-load-error-message","Media encoding is currently running. Try again in few minutes.");break;case"pending":o.MediaPageStore.set("media-load-error-type","encodingPending"),o.MediaPageStore.set("media-load-error-message","Media encoding is pending");break;case"fail":o.MediaPageStore.set("media-load-error-type","encodingFailed"),o.MediaPageStore.set("media-load-error-message","Media encoding failed")}}(t.props.data.encoding_status),null!==o.MediaPageStore.get("media-load-error-type"))return t.state.displayPlayer=!0,V(t);if("string"==typeof t.props.data.poster_url?t.videoPoster=(0,p.formatInnerLink)(t.props.data.poster_url,t.props.siteUrl):"string"==typeof t.props.data.thumbnail_url&&(t.videoPoster=(0,p.formatInnerLink)(t.props.data.thumbnail_url,t.props.siteUrl)),t.videoInfo=(0,C.RA)(t.props.data.encodings_info,t.props.data.hls_info),Object.keys(t.videoInfo).length){var n=o.VideoViewerStore.get("video-quality");(null===n||"Auto"===n&&void 0===t.videoInfo.Auto)&&(n=720);var a=(0,C.$e)(n,t.videoInfo);"Auto"===n&&void 0!==t.videoInfo.Auto&&t.videoSources.push({src:t.videoInfo.Auto.url[0]});var r,l,c=(0,C.KC)();for(l=0;l<t.videoInfo[a].format.length;){if("hls"===t.videoInfo[a].format[l]){t.videoSources.push({src:t.videoInfo[a].url[l]});break}l+=1}for(l in t.props.data.encodings_info[a])t.props.data.encodings_info[a].hasOwnProperty(l)&&c.support[l]&&(r=t.props.data.encodings_info[a][l].url)&&(r=(0,p.formatInnerLink)(r,t.props.siteUrl),t.videoSources.push({src:r,encodings_status:t.props.data.encodings_info[a][l].status}))}else t.videoInfo=null;if(t.videoSources.length){if(!t.props.inEmbed&&1===t.videoSources.length&&"running"===t.videoSources[0].encodings_status)return o.MediaPageStore.set("media-load-error-type","encodingRunning"),o.MediaPageStore.set("media-load-error-message","Media encoding is currently running. Try again in few minutes."),V(t)}else switch(o.MediaPageStore.get("media-load-error-type")){case"encodingRunning":case"encodingPending":case"encodingFailed":break;default:N.warn("VIDEO DEBUG:","Video files don't exist")}o.PageStore.on("switched_media_auto_play",t.onUpdateMediaAutoPlay.bind(R(t))),t.browserCache=new f.BrowserCache(i.SiteContext._currentValue.id,86400);var d=new f.MediaDurationInfo;return d.update(t.props.data.duration),t.durationISO8601=d.ISO8601(),t.playerElem=null,t.playerInstance=null,t.onPlayerInit=t.onPlayerInit.bind(R(t)),t.onClickNext=t.onClickNext.bind(R(t)),t.onClickPrevious=t.onClickPrevious.bind(R(t)),t.onStateUpdate=t.onStateUpdate.bind(R(t)),t.onVideoEnd=t.onVideoEnd.bind(R(t)),t.onVideoRestart=t.onVideoRestart.bind(R(t)),t}return t=u,(n=[{key:"componentDidMount",value:function(){if(this.videoSources.length){this.recommendedMedia=this.props.data.related_media.length?new f.PlayerRecommendedMedia(this.props.data.related_media,this.props.inEmbed,!o.PageStore.get("config-media-item").displayViews):null,this.upNextLoaderView=!this.props.inEmbed&&this.props.data.related_media.length?new f.UpNextLoaderView(this.props.data.related_media[0]):null;var e=null;if(this.props.inEmbed){var t=document.createElement("a"),n=document.createElement("a");(e=document.createElement("div")).setAttribute("class","media-links-top-left"),t&&(t.setAttribute("class","title-link"),t.setAttribute("href",this.props.data.url),t.setAttribute("title",this.props.data.title),t.setAttribute("target","_blank"),t.innerHTML=this.props.data.title),n&&(n.setAttribute("class","user-thumb-link"),n.setAttribute("href",(0,p.formatInnerLink)(this.props.data.author_profile,this.props.siteUrl)),n.setAttribute("title",this.props.data.author_name),n.setAttribute("target","_blank"),n.setAttribute("style","background-image:url("+(0,p.formatInnerLink)(o.MediaPageStore.get("media-author-thumbnail-url"),this.props.siteUrl)+")")),e.appendChild(n),e.appendChild(t)}var a=o.MediaPageStore.get("media-url"),r='<button class="share-video-btn"><i class="material-icons">share</i><span>Share</span></button>';r+='<div class="share-options-wrapper">\t\t\t\t\t\t\t\t\t<div class="share-options">\t\t\t\t\t\t\t\t\t\t<div class="share-options-inner">\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-email">\t\t\t\t\t\t\t\t\t\t\t\t<a href="mailto:?body='+a+'" title=""><span><i class="material-icons">email</i></span><span>Email</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-fb">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://www.facebook.com/sharer.php?u='+a+'" title="" target="_blank"><span></span><span>Facebook</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-tw">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://twitter.com/intent/tweet?url='+a+'" title="" target="_blank"><span></span><span>Twitter</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-whatsapp">\t\t\t\t\t\t\t\t\t\t\t\t<a href="whatsapp://send?text='+a+'" title="" target="_blank" data-action="share/whatsapp/share"><span></span><span>WhatsApp</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-telegram">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://t.me/share/url?url='+a+"&amp;text="+this.props.data.title+'" title="" target="_blank"><span></span><span>Telegram</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-linkedin">\t\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://www.linkedin.com/shareArticle?mini=true&amp;url='+a+'" title="" target="_blank"><span></span><span>LinkedIn</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-reddit">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://reddit.com/submit?url='+a+"&amp;title="+this.props.data.title+'" title="" target="_blank"><span></span><span>reddit</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-tumblr">\t\t\t\t\t\t\t\t\t\t\t\t<a href="https://www.tumblr.com/widgets/share/tool?canonicalUrl='+a+"&amp;title="+this.props.data.title+'" title="" target="_blank"><span></span><span>Tumblr</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-pinterest">\t\t\t\t\t\t\t\t\t\t\t\t<a href="http://pinterest.com/pin/create/link/?url='+a+'" title="" target="_blank"><span></span><span>Pinterest</span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="sh-option share-more">\t\t\t\t\t\t\t\t\t\t\t\t<a href="'+a+'" title="More" target="_blank"><span><i class="material-icons">more_horiz</i></span><span></span></a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>',this.cornerLayers={topLeft:e,topRight:this.upNextLoaderView?this.upNextLoaderView.html():null,bottomLeft:this.recommendedMedia?this.recommendedMedia.html():null,bottomRight:this.props.inEmbed?r:null},this.setState({displayPlayer:!0},(function(){setTimeout((function(){var e=document.querySelector(".share-video-btn"),t=document.querySelector(".share-options-wrapper"),n=document.querySelector(".share-options-inner");e&&e.addEventListener("click",(function(e){(0,p.addClassname)(document.querySelector(".video-js.vjs-mediacms"),"vjs-visible-share-options")})),t&&t.addEventListener("click",(function(e){e.target!==n&&e.target!==t||(0,p.removeClassname)(document.querySelector(".video-js.vjs-mediacms"),"vjs-visible-share-options")}))}),1e3)}))}}},{key:"componentWillUnmount",value:function(){this.unsetRecommendedMedia()}},{key:"initRecommendedMedia",value:function(){null!==this.recommendedMedia&&(this.props.inEmbed||this.recommendedMedia.init(),this.playerInstance.player.on("fullscreenchange",this.recommendedMedia.onResize),o.PageStore.on("window_resize",this.recommendedMedia.onResize),o.VideoViewerStore.on("changed_viewer_mode",this.recommendedMedia.onResize))}},{key:"unsetRecommendedMedia",value:function(){null!==this.recommendedMedia&&(this.playerInstance.player.off("fullscreenchange",this.recommendedMedia.onResize),o.PageStore.removeListener("window_resize",this.recommendedMedia.onResize),o.VideoViewerStore.removeListener("changed_viewer_mode",this.recommendedMedia.onResize),this.recommendedMedia.destroy())}},{key:"onClickNext",value:function(){var e;o.MediaPageStore.get("playlist-id")?null===(e=o.MediaPageStore.get("playlist-next-media-url"))&&(e=this.props.data.related_media[0].url):this.props.inEmbed||(e=this.props.data.related_media[0].url),window.location.href=e}},{key:"onClickPrevious",value:function(){var e;o.MediaPageStore.get("playlist-id")?null===(e=o.MediaPageStore.get("playlist-previous-media-url"))&&(e=this.props.data.related_media[0].url):this.props.inEmbed||(e=this.props.data.related_media[0].url),window.location.href=e}},{key:"onStateUpdate",value:function(e){o.VideoViewerStore.get("in-theater-mode")!==e.theaterMode&&m.VideoViewerActions.set_viewer_mode(e.theaterMode),o.VideoViewerStore.get("player-volume")!==e.volume&&m.VideoViewerActions.set_player_volume(e.volume),o.VideoViewerStore.get("player-sound-muted")!==e.soundMuted&&m.VideoViewerActions.set_player_sound_muted(e.soundMuted),o.VideoViewerStore.get("video-quality")!==e.quality&&m.VideoViewerActions.set_video_quality(e.quality),o.VideoViewerStore.get("video-playback-speed")!==e.playbackSpeed&&m.VideoViewerActions.set_video_playback_speed(e.playbackSpeed)}},{key:"onPlayerInit",value:function(e,t){this.playerElem=t,this.playerInstance=e,this.upNextLoaderView&&(this.upNextLoaderView.setVideoJsPlayerElem(this.playerInstance.player.el_),this.onUpdateMediaAutoPlay()),this.props.inEmbed||this.playerElem.parentNode.focus(),null!==this.recommendedMedia&&(this.recommendedMedia.initWrappers(this.playerElem.parentNode),this.props.inEmbed&&(this.playerInstance.player.one("pause",this.recommendedMedia.init),this.initRecommendedMedia())),this.playerInstance.player.one("ended",this.onVideoEnd)}},{key:"onVideoRestart",value:function(){null!==this.recommendedMedia&&(this.recommendedMedia.updateDisplayType("inline"),this.props.inEmbed&&this.playerInstance.player.one("pause",this.recommendedMedia.init),this.playerInstance.player.one("ended",this.onVideoEnd))}},{key:"onVideoEnd",value:function(){if(null!==this.recommendedMedia&&(this.props.inEmbed||this.initRecommendedMedia(),this.recommendedMedia.updateDisplayType("full"),this.playerInstance.player.one("playing",this.onVideoRestart)),!this.props.inEmbed&&o.MediaPageStore.get("playlist-id")){var e=document.querySelector(".video-player .more-media"),t=document.querySelector(".video-player .vjs-actions-anim");this.upNextLoaderView.cancelTimer();var n=o.MediaPageStore.get("playlist-next-media-url");return n&&(e&&(e.style.display="none"),t&&(t.style.display="none"),window.location.href=n),void this.upNextLoaderView.hideTimerView()}this.upNextLoaderView&&(o.PageStore.get("media-auto-play")?(this.upNextLoaderView.startTimer(),this.playerInstance.player.one("play",function(){this.upNextLoaderView.cancelTimer()}.bind(this))):this.upNextLoaderView.cancelTimer())}},{key:"onUpdateMediaAutoPlay",value:function(){this.upNextLoaderView&&(o.PageStore.get("media-auto-play")?this.upNextLoaderView.showTimerView(this.playerInstance.isEnded()):this.upNextLoaderView.hideTimerView())}},{key:"render",value:function(){var e=this,t=null,n=null;!this.props.inEmbed&&o.MediaPageStore.get("playlist-id")?(t=o.MediaPageStore.get("playlist-next-media-url"),n=o.MediaPageStore.get("playlist-previous-media-url")):t=this.props.data.related_media.length&&!this.props.inEmbed?this.props.data.related_media[0].url:null;var a=this.props.data.sprites_url?{url:this.props.siteUrl+"/"+this.props.data.sprites_url.replace(/^\//g,""),frame:{width:160,height:90,seconds:10}}:null;return r.createElement("div",{key:(this.props.inEmbed?"embed-":"")+"player-container",className:"player-container"+(this.videoSources.length?"":" player-container-error"),style:this.props.containerStyles,ref:"playerContainer"},r.createElement("div",{className:"player-container-inner",ref:"playerContainerInner",style:this.props.containerStyles},this.state.displayPlayer&&null!==o.MediaPageStore.get("media-load-error-type")?r.createElement(A.hJ,{errorMessage:o.MediaPageStore.get("media-load-error-message")}):null,this.state.displayPlayer&&null==o.MediaPageStore.get("media-load-error-type")?r.createElement("div",{className:"video-player",ref:"videoPlayerWrapper",key:"videoPlayerWrapper"},r.createElement(i.SiteConsumer,null,(function(i){return r.createElement(A.Y7,{playerVolume:e.browserCache.get("player-volume"),playerSoundMuted:e.browserCache.get("player-sound-muted"),videoQuality:e.browserCache.get("video-quality"),videoPlaybackSpeed:parseInt(e.browserCache.get("video-playback-speed"),10),inTheaterMode:e.browserCache.get("in-theater-mode"),siteId:i.id,siteUrl:i.url,info:e.videoInfo,cornerLayers:e.cornerLayers,sources:e.videoSources,poster:e.videoPoster,previewSprite:a,subtitlesInfo:e.props.data.subtitles_info,enableAutoplay:!e.props.inEmbed,inEmbed:e.props.inEmbed,hasTheaterMode:!e.props.inEmbed,hasNextLink:!!t,hasPreviousLink:!!n,errorMessage:o.MediaPageStore.get("media-load-error-message"),onClickNextCallback:e.onClickNext,onClickPreviousCallback:e.onClickPrevious,onStateUpdateCallback:e.onStateUpdate,onPlayerInitCallback:e.onPlayerInit})}))):null))}}])&&x(t.prototype,n),u}(r.PureComponent);function j(e){for(var t=null,n=[],a=location.search.substr(1).split("&"),r=0;r<a.length;r++)(n=a[r].split("="))[0]===e&&(t=decodeURIComponent(n[1]));return t}T.defaultProps={inEmbed:!0,siteUrl:u().string.isRequired},T.propTypes={inEmbed:u().bool},new MutationObserver((function(e,t){var n,a=document.querySelector(".video-js.vjs-mediacms video");if(a)return(n=videojs(a)).playsinline(!0),1==j("muted")&&n.muted(!0),j("time")>=0&&n.currentTime(j("time")),1==j("autoplay")&&n.play(),void t.disconnect()})).observe(document,{childList:!0,subtree:!0}),n(9808);var D=n(2546),U=n(4234),q=n(1283);function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function z(e){var t,n,a=[];if(e.length)for(t=0,n=1<e.length?", ":"";t<e.length;)a[t]=r.createElement("div",{key:t},r.createElement("a",{href:e[t].url,title:e[t].title},e[t].title),t<e.length-1?n:""),t+=1;return a}function H(e){return r.createElement("div",{className:"media-author-banner"},r.createElement("div",null,r.createElement("a",{className:"author-banner-thumb",href:e.link||null,title:e.name},r.createElement("span",{style:{backgroundImage:"url("+e.thumb+")"}},r.createElement("img",{src:e.thumb,loading:"lazy",alt:e.name,title:e.name})))),r.createElement("div",null,r.createElement("span",null,r.createElement("a",{href:e.link,className:"author-banner-name",title:e.name},r.createElement("span",null,e.name))),o.PageStore.get("config-media-item").displayPublishDate&&e.published?r.createElement("span",{className:"author-banner-date"},"Published on ",(0,p.publishedOnDate)(new Date(e.published))):null))}function W(e){return r.createElement("div",{className:e.id.trim()?"media-content-"+e.id.trim():null},r.createElement("div",{className:"media-content-field"},r.createElement("div",{className:"media-content-field-label"},r.createElement("h4",null,e.title)),r.createElement("div",{className:"media-content-field-content"},e.value)))}function $(e){var t=e.link;return window.MediaCMS.site.devEnv&&(t="/edit-media.html"),r.createElement("a",{href:t,rel:"nofollow",title:"Edit media",className:"edit-media"},"EDIT MEDIA")}function Q(e){var t=e.link;return window.MediaCMS.site.devEnv&&(t="#"),r.createElement("a",{href:t,rel:"nofollow",title:"Edit subtitle",className:"edit-subtitle"},"EDIT SUBTITLE")}function J(e){var t=(0,D.useUser)().userCan,n=e.description.trim(),a=!o.PageStore.get("config-enabled").taxonomies.tags||o.PageStore.get("config-enabled").taxonomies.tags.enabled?z(o.MediaPageStore.get("media-tags")):[],l=o.PageStore.get("config-options").pages.media.categoriesWithTitle?[]:!o.PageStore.get("config-enabled").taxonomies.categories||o.PageStore.get("config-enabled").taxonomies.categories.enabled?z(o.MediaPageStore.get("media-categories")):[],s=o.MediaPageStore.get("media-summary");s=s?s.trim():"";var u=F((0,D.usePopup)(),3),c=u[0],d=u[1],f=u[2],y=F((0,r.useState)(""!==s),2),h=y[0],g=(y[1],F((0,r.useState)(""==s),2)),v=g[0],b=g[1];function S(e){setTimeout((function(){m.PageActions.addNotification("Media removed. Redirecting...","mediaDelete"),setTimeout((function(){window.location.href=i.SiteContext._currentValue.url+"/"+o.MediaPageStore.get("media-data").author_profile.replace(/^\//g,"")}),2e3)}),100),void 0!==e&&q.info("Removed media '"+e+'"')}function w(e){setTimeout((function(){m.PageActions.addNotification("Media removal failed","mediaDeleteFail")}),100),void 0!==e&&q.info('Media "'+e+'" removal failed')}(0,r.useEffect)((function(){return o.MediaPageStore.on("media_delete",S),o.MediaPageStore.on("media_delete_fail",w),function(){o.MediaPageStore.removeListener("media_delete",S),o.MediaPageStore.removeListener("media_delete_fail",w)}}),[]);var P=(0,p.formatInnerLink)(e.author.url,i.SiteContext._currentValue.url),E=(0,p.formatInnerLink)(e.author.thumb,i.SiteContext._currentValue.url);return r.createElement("div",{className:"media-info-content"},void 0===o.PageStore.get("config-media-item").displayAuthor||null===o.PageStore.get("config-media-item").displayAuthor||o.PageStore.get("config-media-item").displayAuthor?r.createElement(H,{link:P,thumb:E,name:e.author.name,published:e.published}):null,r.createElement("div",{className:"media-content-banner"},r.createElement("div",{className:"media-content-banner-inner"},h?r.createElement("div",{className:"media-content-summary"},s):null,h&&!v||!n?null:o.PageStore.get("config-options").pages.media.htmlInDescription?r.createElement("div",{className:"media-content-description",dangerouslySetInnerHTML:{__html:n}}):r.createElement("div",{className:"media-content-description"},n),h?r.createElement("button",{className:"load-more",onClick:function(){b(!v)}},v?"SHOW LESS":"SHOW MORE"):null,a.length?r.createElement(W,{value:a,title:1<a.length?"Tags":"Tag",id:"tags"}):null,l.length?r.createElement(W,{value:l,title:1<l.length?"Categories":"Category",id:"categories"}):null,t.editMedia||t.editSubtitle||t.deleteMedia?r.createElement("div",{className:"media-author-actions"},t.editMedia?r.createElement($,{link:o.MediaPageStore.get("media-data").edit_url}):null,t.editSubtitle&&"video"===o.MediaPageStore.get("media-data").media_type?r.createElement(Q,{link:o.MediaPageStore.get("media-data").edit_url.replace("edit?","add_subtitle?")}):null,r.createElement(f,{contentRef:c},r.createElement("button",{className:"remove-media"},"DELETE MEDIA")),r.createElement(d,{contentRef:c},r.createElement(U.PopupMain,null,r.createElement("div",{className:"popup-message"},r.createElement("span",{className:"popup-message-title"},"Media removal"),r.createElement("span",{className:"popup-message-main"},"You're willing to remove media permanently?")),r.createElement("hr",null),r.createElement("span",{className:"popup-message-bottom"},r.createElement("button",{className:"button-link cancel-comment-removal",onClick:function(){c.current.toggle()}},"CANCEL"),r.createElement("button",{className:"button-link proceed-comment-removal",onClick:function(){m.MediaPageActions.removeMedia(),c.current.toggle()}},"PROCEED"))))):null)))}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function K(){var e=Y((0,r.useState)(o.MediaPageStore.get("user-liked-media")),2),t=e[0],n=e[1],a=Y((0,r.useState)((0,p.formatViewsNumber)(o.MediaPageStore.get("media-likes"),!1)),2),l=a[0],s=a[1];function u(){n(o.MediaPageStore.get("user-disliked-media")),s((0,p.formatViewsNumber)(o.MediaPageStore.get("media-dislikes"),!1))}function c(){u(),m.PageActions.addNotification(i.TextsContext._currentValue.messages.addToDisliked,"mediaDislike")}function d(){u(),m.PageActions.addNotification(i.TextsContext._currentValue.messages.removeFromDisliked,"cancelMediaDislike")}function f(){m.PageActions.addNotification("Action failed","mediaDislikeRequestFail")}return(0,r.useEffect)((function(){return o.MediaPageStore.on("disliked_media",c),o.MediaPageStore.on("undisliked_media",d),o.MediaPageStore.on("disliked_media_failed_request",f),function(){o.MediaPageStore.removeListener("disliked_media",c),o.MediaPageStore.removeListener("undisliked_media",d),o.MediaPageStore.removeListener("disliked_media_failed_request",f)}}),[]),r.createElement("div",{className:"like"},r.createElement("button",{onClick:function(e){e.preventDefault(),e.stopPropagation(),m.MediaPageActions[t?"undislikeMedia":"dislikeMedia"]()}},r.createElement(U.CircleIconButton,{type:"span"},r.createElement(U.MaterialIcon,{type:"thumb_down"})),r.createElement("span",{className:"dislikes-counter"},l)))}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ee(){var e=X((0,r.useState)(o.MediaPageStore.get("user-liked-media")),2),t=e[0],n=e[1],a=X((0,r.useState)((0,p.formatViewsNumber)(o.MediaPageStore.get("media-likes"),!1)),2),l=a[0],s=a[1];function u(){n(o.MediaPageStore.get("user-liked-media")),s((0,p.formatViewsNumber)(o.MediaPageStore.get("media-likes"),!1))}function c(){u(),m.PageActions.addNotification(i.TextsContext._currentValue.addToLiked,"likedMedia")}function d(){u(),m.PageActions.addNotification(i.TextsContext._currentValue.removeFromLiked,"unlikedMedia")}function f(){m.PageActions.addNotification("Action failed","likedMediaRequestFail")}return(0,r.useEffect)((function(){return o.MediaPageStore.on("liked_media",c),o.MediaPageStore.on("unliked_media",d),o.MediaPageStore.on("liked_media_failed_request",f),function(){o.MediaPageStore.removeListener("liked_media",c),o.MediaPageStore.removeListener("unliked_media",d),o.MediaPageStore.removeListener("liked_media_failed_request",f)}}),[]),r.createElement("div",{className:"like"},r.createElement("button",{onClick:function(e){e.preventDefault(),e.stopPropagation(),m.MediaPageActions[t?"unlikeMedia":"likeMedia"]()}},r.createElement(U.CircleIconButton,{type:"span"},r.createElement(U.MaterialIcon,{type:"thumb_up"})),r.createElement("span",{className:"likes-counter"},l)))}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ne(e){var t,n,a=(0,r.useRef)(null),i=(0,r.useRef)(null),l=(t=(0,r.useState)(null),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=l[0],u=l[1];function c(){u(window.innerHeight-(104+a.current.offsetHeight))}return(0,r.useEffect)((function(){return c(),o.PageStore.on("window_resize",c),function(){o.PageStore.removeListener("window_resize",c)}}),[]),r.createElement("form",null,r.createElement("div",{className:"report-form",style:null!==s?{maxHeight:s+"px"}:null},r.createElement("div",{className:"form-title"},"Report media"),r.createElement("div",{className:"form-field"},r.createElement("span",{className:"label"},"URL"),r.createElement("input",{type:"text",readOnly:!0,value:e.mediaUrl})),r.createElement("div",{className:"form-field"},r.createElement("span",{className:"label"},"Description"),r.createElement("textarea",{ref:i,required:!0})),r.createElement("div",{className:"form-field form-help-text"},"Reported media is reviewed")),r.createElement("div",{ref:a,className:"form-actions-bottom"},r.createElement("button",{className:"cancel",onClick:function(t){t.preventDefault(),void 0!==e.cancelReportForm&&e.cancelReportForm()}},"CANCEL"),r.createElement("button",{onClick:function(t){var n=i.current.value.trim();""!==n&&(t.preventDefault(),void 0!==e.submitReportForm&&e.submitReportForm(n))}},"SUBMIT")))}function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ie(e,t){var n,a,r=i.SiteContext._currentValue,o=e.encodings_info,l={};for(n in o)if(o.hasOwnProperty(n)&&Object.keys(o[n]).length)for(a in o[n])o[n].hasOwnProperty(a)&&"success"===o[n][a].status&&100===o[n][a].progress&&(l[o[n][a].title]={text:n+" - "+a.toUpperCase()+" ("+o[n][a].size+")",link:(0,p.formatInnerLink)(o[n][a].url,r.url),linkAttr:{target:"_blank",download:e.title+"_"+n+"_"+a.toUpperCase()}});return l.original_media_url={text:"Original file ("+e.size+")",link:(0,p.formatInnerLink)(e.original_media_url,r.url),linkAttr:{target:"_blank",download:e.title}},Object.values(l)}function oe(e,t,n,a,i,o,l){var s=t.url,u=t.media_type,c=t.state||"N/A",d=t.encoding_status||"N/A",p=t.reported_times,m=t.is_reviewed,f="video"===u,y=function(e,t,n,a,r){var i=[],o="video"===t.media_type,l=t.reported_times;return n&&e.downloadMedia&&(o?i.push({itemType:"open-subpage",text:"Download",icon:"arrow_downward",itemAttr:{className:"visible-only-in-small"},buttonAttr:{className:"change-page","data-page-id":"videoDownloadOptions"}}):a&&i.push({itemType:"link",link:a,text:"Download",icon:"arrow_downward",itemAttr:{className:"visible-only-in-small"},linkAttr:{target:"_blank",download:t.title}})),o&&e.editMedia&&i.push({itemType:"open-subpage",text:"Status info",icon:"info",buttonAttr:{className:"change-page","data-page-id":"mediaStatusInfo"}}),e.reportMedia&&(r?i.push({itemType:"div",text:"Reported",icon:"flag",divAttr:{className:"reported-label loggedin-media-reported"}}):i.push({itemType:"open-subpage",text:"Report",icon:"flag",buttonAttr:{className:"change-page"+(l?" loggedin-media-reported":""),"data-page-id":"loggedInReportMedia"}})),i}(e,t,n,a,i),h={};return y.length&&(h.main=r.createElement("div",{className:"main-options"},r.createElement(U.PopupMain,null,r.createElement(U.NavigationMenuList,{items:y})))),e.reportMedia&&(h.loggedInReportMedia=i?null:r.createElement("div",{className:"popup-fullscreen"},r.createElement(U.PopupMain,null,r.createElement("span",{className:"popup-fullscreen-overlay"}),r.createElement("div",null,r.createElement(ne,{mediaUrl:s,submitReportForm:o,cancelReportForm:l}))))),e.editMedia&&(h.mediaStatusInfo=r.createElement("div",{className:"main-options"},r.createElement(U.PopupMain,null,r.createElement("ul",{className:"media-status-info"},r.createElement("li",null,"Media type: ",r.createElement("span",null,u)),r.createElement("li",null,"State: ",r.createElement("span",null,c)),r.createElement("li",null,"Review state: ",r.createElement("span",null,m?"Is reviewed":"Pending review")),f?r.createElement("li",null,"Encoding Status: ",r.createElement("span",null,d)):null,p?r.createElement("li",{className:"reports"},"Reports: ",r.createElement("span",null,p)):null)))),n&&e.downloadMedia&&f&&(h.videoDownloadOptions=r.createElement("div",{className:"video-download-options"},r.createElement(U.PopupMain,null,r.createElement(U.NavigationMenuList,{items:ie(t)})))),h}n(9628),ne.propTypes={mediaUrl:u().string.isRequired,cancelReportForm:u().func,submitReportForm:u().func};var le="more-options active-options";function se(e){var t=(0,D.useUser)().userCan,n=i.SiteContext._currentValue,a=(0,p.formatInnerLink)(o.MediaPageStore.get("media-original-url"),n.url),l=o.MediaPageStore.get("media-data"),s="video"===l.media_type,u=ae((0,D.usePopup)(),3),c=u[0],d=u[1],f=u[2],y=ae((0,r.useState)(!1),2),h=y[0],g=y[1],v=ae((0,r.useState)(!1),2),b=v[0],S=v[1],w=ae((0,r.useState)({}),2),P=w[0],E=w[1],M=ae((0,r.useState)("main"),2),_=M[0],k=M[1],C=ae((0,r.useState)(le),2),A=C[0],N=C[1];function O(e){m.MediaPageActions.reportMedia(e)}function x(){c.current.toggle()}function I(){c.current.tryToHide(),setTimeout((function(){m.PageActions.addNotification("Media Reported","reportedMedia"),S(!0),o.MediaPageStore.removeListener("reported_media",I)}),100)}return(0,r.useEffect)((function(){b||(h?o.MediaPageStore.on("reported_media",I):o.MediaPageStore.removeListener("reported_media",I))}),[h]),(0,r.useEffect)((function(){g(Object.keys(P).length&&e.allowDownload&&t.downloadMedia)}),[P]),(0,r.useEffect)((function(){var n=le;e.allowDownload&&t.downloadMedia&&"videoDownloadOptions"===_&&(n+=" video-downloads"),1===Object.keys(P).length&&e.allowDownload&&t.downloadMedia&&(s||a)&&(n+=" visible-only-in-small"),N(n)}),[_]),(0,r.useEffect)((function(){E(oe(t,l,e.allowDownload,a,b,O,x))}),[b]),(0,r.useEffect)((function(){return E(oe(t,l,e.allowDownload,a,b,O,x)),function(){h&&!b&&o.MediaPageStore.removeListener("reported_media",I)}}),[]),h?r.createElement("div",{className:A},r.createElement(f,{contentRef:c},r.createElement("span",null,r.createElement(U.CircleIconButton,{type:"button"},r.createElement(U.MaterialIcon,{type:"more_horiz"})))),r.createElement("div",{className:"nav-page-"+_},r.createElement(d,{contentRef:c,hideCallback:function(){k("main")}},r.createElement(U.NavigationContentApp,{pageChangeCallback:function(e){k(e)},initPage:_,focusFirstItemOnPageChange:!1,pages:P,pageChangeSelector:".change-page",pageIdSelectorAttr:"data-page-id"})))):null}se.propTypes={allowDownload:u().bool.isRequired},se.defaultProps={allowDownload:!1};var ue=n(7642);function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function pe(e){return e.renderDate?r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:e.isChecked,onChange:function(t){t.persist(),e.isChecked?m.MediaPageActions.removeMediaFromPlaylist(e.playlistId,o.MediaPageStore.get("media-id")):m.MediaPageActions.addMediaToPlaylist(e.playlistId,o.MediaPageStore.get("media-id"))}}),r.createElement("span",null,e.title)):null}function me(e){var t=(0,r.useRef)(null),n=(0,r.useRef)(null),a=ce((0,r.useState)(new Date),2),i=a[0],l=a[1],s=ce((0,r.useState)(o.MediaPageStore.get("playlists")),2),u=s[0],c=s[1],d=ce((0,r.useState)(!1),2),p=d[0],f=d[1];function y(){w()}function h(){c(o.MediaPageStore.get("playlists")),l(new Date)}function g(){c(o.MediaPageStore.get("playlists")),l(new Date),setTimeout((function(){m.PageActions.addNotification("Media added to playlist","playlistMediaAdditionComplete")}),100)}function v(){setTimeout((function(){m.PageActions.addNotification("Media's addition to playlist failed","playlistMediaAdditionFail")}),100)}function b(){c(o.MediaPageStore.get("playlists")),l(new Date),setTimeout((function(){m.PageActions.addNotification("Media removed from playlist","playlistMediaRemovalComplete")}),100)}function S(){setTimeout((function(){m.PageActions.addNotification("Media's removal from playlist failed","playlistMediaaRemovalFail")}),100)}function w(){null!==n.current&&(n.current.style.maxHeight=window.innerHeight-74-(t.current.offsetHeight-n.current.offsetHeight)+"px")}function P(){f(!p),w()}return(0,r.useEffect)((function(){w()})),(0,r.useEffect)((function(){return o.PageStore.on("window_resize",y),o.MediaPageStore.on("playlists_load",h),o.MediaPageStore.on("media_playlist_addition_completed",g),o.MediaPageStore.on("media_playlist_addition_failed",v),o.MediaPageStore.on("media_playlist_removal_completed",b),o.MediaPageStore.on("media_playlist_removal_failed",S),function(){o.PageStore.removeListener("window_resize",y),o.MediaPageStore.removeListener("playlists_load",h),o.MediaPageStore.removeListener("media_playlist_addition_completed",g),o.MediaPageStore.removeListener("media_playlist_addition_failed",v),o.MediaPageStore.removeListener("media_playlist_removal_completed",b),o.MediaPageStore.removeListener("media_playlist_removal_failed",S)}}),[]),r.createElement("div",{ref:t,className:"saveto-popup"},r.createElement("div",{className:"saveto-title"},"Save to...",r.createElement(U.CircleIconButton,{type:"button",onClick:function(){f(!1),void 0!==e.triggerPopupClose&&e.triggerPopupClose()}},r.createElement(U.MaterialIcon,{type:"close"}))),u.length?r.createElement("div",{ref:n,className:"saveto-select"},function(){for(var e=o.MediaPageStore.get("media-id"),t=[],n=0;n<u.length;)t.push(r.createElement("div",{key:"playlist_"+u[n].playlist_id},r.createElement(pe,{renderDate:i,title:u[n].title,privacy:u[n].status,isChecked:-1<u[n].media_list.indexOf(e),playlistId:u[n].playlist_id}))),n+=1;return t}()):null,p?r.createElement("div",{className:"saveto-new-playlist"},r.createElement(ue.A,{onCancel:P,onPlaylistSave:function(e){m.MediaPageActions.addNewPlaylist(e),P()}})):r.createElement(U.CircleIconButton,{className:"saveto-create",type:"button",onClick:P},r.createElement(U.MaterialIcon,{type:"add"}),"Create a new playlist"))}function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ye(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function he(e){var t,n=fe((0,D.usePopup)(),3),a=n[0],i=n[1],o=n[2],l=fe((0,r.useState)("selectPlaylist"),2),s=l[0],u=l[1];return r.createElement("div",{className:"save"},r.createElement(o,{contentRef:a},r.createElement("button",null,r.createElement(U.CircleIconButton,{type:"span"},r.createElement(U.MaterialIcon,{type:"playlist_add"})),r.createElement("span",null,"SAVE"))),r.createElement(i,{contentRef:a},r.createElement(U.NavigationContentApp,{initPage:s,pageChangeSelector:".change-page",pageIdSelectorAttr:"data-page-id",pages:(t=function(){a.current.toggle()},{selectPlaylist:r.createElement("div",{className:"popup-fullscreen"},r.createElement(U.PopupMain,null,r.createElement("span",{className:"popup-fullscreen-overlay"}),r.createElement(me,{triggerPopupClose:t}))),createPlaylist:r.createElement("div",{className:"popup-fullscreen"},r.createElement(U.PopupMain,null,r.createElement("span",{className:"popup-fullscreen-overlay"})))}),focusFirstItemOnPageChange:!1,pageChangeCallback:u})))}function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ve(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function be(e){var t=(0,r.useRef)(null),n=ge((0,r.useState)([]),2),a=n[0],i=n[1],l=ge((0,r.useState)(!0),2),s=l[0],u=l[1],c=ge((0,r.useState)(""),2),d=c[0],p=c[1],f=ge((0,r.useState)(""),2),y=f[0],h=f[1],g=ge((0,r.useState)(""),2),v=g[0],b=g[1],S=ge((0,r.useState)(""),2),w=S[0],P=S[1],E=ge((0,r.useState)(""),2),M=E[0],_=E[1],k=ge((0,r.useState)(!1),2),C=k[0],A=k[1],N=ge((0,r.useState)(!1),2),O=N[0],x=N[1],I=ge((0,r.useState)(!1),2),V=I[0],R=I[1];function L(){i(o.MediaPageStore.get("technique-tree")),u(!1)}function T(){u(!1)}function j(){R(!1),setTimeout((function(){m.PageActions.addNotification("Video added to technique","techniqueMediaAdditionComplete")}),100),void 0!==e.triggerPopupClose&&e.triggerPopupClose()}function D(){R(!1),setTimeout((function(){m.PageActions.addNotification("Failed to add video to technique","techniqueMediaAdditionFail")}),100)}function q(){R(!1),setTimeout((function(){m.PageActions.addNotification("This video is already added to this technique","techniqueMediaAlreadyAdded")}),100)}function F(){return y||d||""}function B(e,t){var n={title:e};return t&&(n.parent_id=t),fetch("/api/v1/techniques/categories",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":z()},body:JSON.stringify(n)}).then((function(e){return e.json()}))}function z(){var e=document.cookie.match(/csrftoken=([^;]+)/);return e?e[1]:""}(0,r.useEffect)((function(){var e=o.MediaPageStore.get("media-data");return e&&e.title&&b(e.title),o.MediaPageStore.on("technique_tree_loaded",L),o.MediaPageStore.on("technique_tree_load_failed",T),o.MediaPageStore.on("technique_media_addition_completed",j),o.MediaPageStore.on("technique_media_addition_failed",D),o.MediaPageStore.on("technique_media_already_added",q),m.MediaPageActions.loadTechniqueTree(),function(){o.MediaPageStore.removeListener("technique_tree_loaded",L),o.MediaPageStore.removeListener("technique_tree_load_failed",T),o.MediaPageStore.removeListener("technique_media_addition_completed",j),o.MediaPageStore.removeListener("technique_media_addition_failed",D),o.MediaPageStore.removeListener("technique_media_already_added",q)}}),[]);var H=function(){if(!d)return[];var e=a.find((function(e){return e.id===d}));return e&&e.children?e.children:[]}(),W=w.trim()&&!d,$=d&&M.trim()&&!y,Q=(F()||W||$)&&v.trim()&&!V;return r.createElement("div",{ref:t,className:"technique-popup"},r.createElement("div",{className:"technique-title"},"Add to Techniques",r.createElement(U.CircleIconButton,{type:"button",onClick:function(){void 0!==e.triggerPopupClose&&e.triggerPopupClose()}},r.createElement(U.MaterialIcon,{type:"close"}))),s?r.createElement("div",{className:"technique-loading"},"Loading..."):r.createElement("div",{className:"technique-form"},r.createElement("div",{className:"technique-field"},r.createElement("label",null,"Category"),r.createElement("select",{value:d,onChange:function(e){p(e.target.value),h("")}},r.createElement("option",{value:""},"Select category..."),a.map((function(e){return r.createElement("option",{key:e.id,value:e.id},e.title)}))),r.createElement("div",{className:"technique-create-new"},r.createElement("input",{type:"text",placeholder:"New category name...",value:w,onChange:function(e){P(e.target.value)}}),r.createElement("button",{onClick:function(){w.trim()&&(A(!0),fetch("/api/v1/techniques/categories",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":z()},body:JSON.stringify({title:w.trim()})}).then((function(e){return e.json()})).then((function(e){A(!1),P(""),m.MediaPageActions.loadTechniqueTree(),e.id&&p(e.id)})).catch((function(){A(!1)})))},disabled:C||!w.trim()},C?"...":"Create"))),d?r.createElement("div",{className:"technique-field"},r.createElement("label",null,"Subcategory"),r.createElement("select",{value:y,onChange:function(e){h(e.target.value)}},r.createElement("option",{value:""},"Select subcategory..."),H.map((function(e){return r.createElement("option",{key:e.id,value:e.id},e.title)}))),r.createElement("div",{className:"technique-create-new"},r.createElement("input",{type:"text",placeholder:"New subcategory name...",value:M,onChange:function(e){_(e.target.value)}}),r.createElement("button",{onClick:function(){M.trim()&&d&&(x(!0),fetch("/api/v1/techniques/categories",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":z()},body:JSON.stringify({parent_id:d,title:M.trim()})}).then((function(e){return e.json()})).then((function(e){x(!1),_(""),m.MediaPageActions.loadTechniqueTree(),e.id&&h(e.id)})).catch((function(){x(!1)})))},disabled:O||!M.trim()},O?"...":"Create"))):null,r.createElement("div",{className:"technique-field"},r.createElement("label",null,"Technique title"),r.createElement("input",{type:"text",value:v,onChange:function(e){b(e.target.value)},placeholder:"Technique title..."})),r.createElement("button",{className:"technique-submit",onClick:function(){if(v.trim()){R(!0);var e=o.MediaPageStore.get("media-id"),t=v.trim();if(!w.trim()||d)if(d&&M.trim()&&!y)B(M.trim(),d).then((function(n){if(!n.id)throw new Error("Subcategory creation failed");_(""),h(n.id),m.MediaPageActions.loadTechniqueTree(),m.MediaPageActions.addMediaToTechnique(n.id,e,t)})).catch((function(){R(!1),m.PageActions.addNotification("Failed to create subcategory","subcategoryCreationFail")}));else{var n=F();n&&m.MediaPageActions.addMediaToTechnique(n,e,t)}else B(w.trim()).then((function(e){if(!e.id)throw new Error("Category creation failed");return P(""),p(e.id),m.MediaPageActions.loadTechniqueTree(),M.trim()?B(M.trim(),e.id).then((function(e){if(!e.id)throw new Error("Subcategory creation failed");return _(""),h(e.id),m.MediaPageActions.loadTechniqueTree(),e.id})):e.id})).then((function(n){m.MediaPageActions.addMediaToTechnique(n,e,t)})).catch((function(){R(!1),m.PageActions.addNotification("Failed to create category","categoryCreationFail")}))}},disabled:!Q},V?"Adding...":"Add to Techniques")))}function Se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Pe(e){var t,n=Se((0,D.usePopup)(),3),a=n[0],i=n[1],o=n[2],l=Se((0,r.useState)("selectTechnique"),2),s=l[0],u=l[1];return r.createElement("div",{className:"technique"},r.createElement(o,{contentRef:a},r.createElement("button",null,r.createElement(U.CircleIconButton,{type:"span"},r.createElement(U.MaterialIcon,{type:"fitness_center"})),r.createElement("span",null,"TECHNIQUE"))),r.createElement(i,{contentRef:a},r.createElement(U.NavigationContentApp,{initPage:s,pageChangeSelector:".change-page",pageIdSelectorAttr:"data-page-id",pages:(t=function(){a.current.toggle()},{selectTechnique:r.createElement("div",{className:"popup-fullscreen"},r.createElement(U.PopupMain,null,r.createElement("span",{className:"popup-fullscreen-overlay"}),r.createElement(be,{triggerPopupClose:t})))}),focusFirstItemOnPageChange:!1,pageChangeCallback:u})))}function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Me(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _e(e){var t=o.PageStore.get("config-options").embedded.video.dimensions,n=(0,r.useContext)(i.LinksContext),a=(0,r.useRef)(null),l=(0,r.useRef)(null),s=(0,r.useRef)(null),u=(0,r.useRef)(null),c=(0,r.useRef)(null),d=Ee((0,r.useState)(window.innerHeight-144+56),2),p=d[0],f=d[1],y=Ee((0,r.useState)(!1),2),h=y[0],g=y[1],v=Ee((0,r.useState)("16:9"),2),b=v[0],S=v[1],w=Ee((0,r.useState)(t.width),2),P=w[0],E=w[1],M=Ee((0,r.useState)(t.widthUnit),2),_=M[0],k=M[1],C=Ee((0,r.useState)(t.height),2),A=C[0],N=C[1],O=Ee((0,r.useState)(t.heightUnit),2),x=O[0],I=O[1],V=Ee((0,r.useState)(60),2),R=V[0],L=V[1],j=Ee((0,r.useState)(60),2),D=j[0],q=j[1],F=Ee((0,r.useState)([{key:"px",label:"px"},{key:"percent",label:"%"}]),2),B=F[0],z=F[1];function H(){f(window.innerHeight-144+56),L(s.current.offsetHeight),q(c.current.offsetHeight)}function W(){setTimeout((function(){m.PageActions.addNotification("Embed media code copied to clipboard","clipboardEmbedMediaCodeCopy")}),100)}return(0,r.useEffect)((function(){f(window.innerHeight-144+56),L(s.current.offsetHeight),q(c.current.offsetHeight)})),(0,r.useEffect)((function(){return o.PageStore.on("window_resize",H),o.MediaPageStore.on("copied_embed_media_code",W),function(){o.PageStore.removeListener("window_resize",H),o.MediaPageStore.removeListener("copied_embed_media_code",W)}}),[]),r.createElement("div",{className:"share-embed",style:{maxHeight:p+"px"}},r.createElement("div",{className:"share-embed-inner"},r.createElement("div",{className:"on-left"},r.createElement("div",{className:"media-embed-wrap"},r.createElement(T,{data:o.MediaPageStore.get("media-data"),inEmbed:!0}))),r.createElement("div",{ref:l,className:"on-right"},r.createElement("div",{ref:s,className:"on-right-top"},r.createElement("div",{className:"on-right-top-inner"},r.createElement("span",{className:"ttl"},"Embed Video"),r.createElement(U.CircleIconButton,{type:"button",onClick:function(){void 0!==e.triggerPopupClose&&e.triggerPopupClose()}},r.createElement(U.MaterialIcon,{type:"close"})))),r.createElement("div",{ref:u,className:"on-right-middle",style:{top:R+"px",bottom:D+"px"}},r.createElement("textarea",{readOnly:!0,value:'<iframe width="'+("percent"===_?P+"%":P)+'" height="'+("percent"===x?A+"%":A)+'" src="'+n.embed+o.MediaPageStore.get("media-id")+'" frameborder="0" allowfullscreen></iframe>'}),r.createElement("div",{className:"iframe-config"},r.createElement("div",{className:"iframe-config-options-title"},"Embed options"),r.createElement("div",{className:"iframe-config-option"},r.createElement("div",{className:"option-content"},r.createElement("div",{className:"ratio-options"},r.createElement("div",{className:"options-group"},r.createElement("label",{style:{minHeight:"36px"}},r.createElement("input",{type:"checkbox",checked:h,onChange:function(){var e=!h,t=b.split(":"),n=t[0],a=t[1];g(e),k(e?"px":_),I(e?"px":x),N(e?parseInt(P*a/n,10):A),z(e?[{key:"px",label:"px"}]:[{key:"px",label:"px"},{key:"percent",label:"%"}])}}),"Keep aspect ratio")),h?r.createElement("div",{className:"options-group"},r.createElement("select",{ref:a,onChange:function(){var e=a.current.value,t=e.split(":"),n=t[0],r=t[1];S(e),N(h?parseInt(P*r/n,10):A)},value:b},r.createElement("optgroup",{label:"Horizontal orientation"},r.createElement("option",{value:"16:9"},"16:9"),r.createElement("option",{value:"4:3"},"4:3"),r.createElement("option",{value:"3:2"},"3:2")),r.createElement("optgroup",{label:"Vertical orientation"},r.createElement("option",{value:"9:16"},"9:16"),r.createElement("option",{value:"3:4"},"3:4"),r.createElement("option",{value:"2:3"},"2:3")))):null),r.createElement("br",null),r.createElement("div",{className:"options-group"},r.createElement(U.NumericInputWithUnit,{valueCallback:function(e){e=""===e?0:e;var t=b.split(":"),n=t[0],a=t[1];E(e),N(h?parseInt(e*a/n,10):A)},unitCallback:function(e){k(e)},label:"Width",defaultValue:parseInt(P,10),defaultUnit:_,minValue:1,maxValue:99999,units:B})),r.createElement("div",{className:"options-group"},r.createElement(U.NumericInputWithUnit,{valueCallback:function(e){e=""===e?0:e;var t=b.split(":"),n=t[0],a=t[1];N(e),E(h?parseInt(e*n/a,10):P)},unitCallback:function(e){I(e)},label:"Height",defaultValue:parseInt(A,10),defaultUnit:x,minValue:1,maxValue:99999,units:B})))))),r.createElement("div",{ref:c,className:"on-right-bottom"},r.createElement("button",{onClick:function(){m.MediaPageActions.copyEmbedMediaCode(u.current.querySelector("textarea"))}},"COPY")))))}pe.propTypes={playlistId:u().string,isChecked:u().bool,title:u().string},pe.defaultProps={isChecked:!1,title:""},me.propTypes={triggerPopupClose:u().func},n(7715),n(5334),n(5017),n(2070),be.propTypes={triggerPopupClose:u().func},n(8833),n(815),n(9174),_e.propTypes={triggerPopupClose:u().func};var ke=n(3458);function Ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ae(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Ne(e){var t=e.onClick;return r.createElement("span",{className:"next-slide"},r.createElement(U.CircleIconButton,{buttonShadow:!0,onClick:t},r.createElement("i",{className:"material-icons"},"keyboard_arrow_right")))}function Oe(e){var t=e.onClick;return r.createElement("span",{className:"previous-slide"},r.createElement(U.CircleIconButton,{buttonShadow:!0,onClick:t},r.createElement("i",{className:"material-icons"},"keyboard_arrow_left")))}function xe(){return{maxFormContentHeight:window.innerHeight-196,maxPopupWidth:518>window.innerWidth-80?window.innerWidth-80:null}}function Ie(e){var t=(0,r.useRef)(null),n=(0,r.useRef)(null),a=Ce((0,r.useState)(null),2),l=a[0],s=a[1],u=Ce((0,r.useState)({prev:!1,next:!1}),2),c=u[0],d=u[1],p=Ce((0,r.useState)(xe()),2),f=p[0],y=p[1],h=Ce((0,r.useState)(function(){var e=function(){for(var e=i.ShareOptionsContext._currentValue,t=o.MediaPageStore.get("media-url"),n=o.MediaPageStore.get("media-data").title,a={},r=0;r<e.length;){switch(e[r]){case"embed":"video"===o.MediaPageStore.get("media-data").media_type&&(a[e[r]]={});break;case"email":a[e[r]]={title:"Email",shareUrl:"mailto:?body="+t};break;case"fb":a[e[r]]={title:"Facebook",shareUrl:"https://www.facebook.com/sharer.php?u="+t};break;case"tw":a[e[r]]={title:"Twitter",shareUrl:"https://twitter.com/intent/tweet?url="+t};break;case"reddit":a[e[r]]={title:"reddit",shareUrl:"https://reddit.com/submit?url="+t+"&title="+n};break;case"tumblr":a[e[r]]={title:"Tumblr",shareUrl:"https://www.tumblr.com/widgets/share/tool?canonicalUrl="+t+"&title="+n};break;case"pinterest":a[e[r]]={title:"Pinterest",shareUrl:"http://pinterest.com/pin/create/link/?url="+t};break;case"vk":a[e[r]]={title:"",shareUrl:"http://vk.com/share.php?url="+t+"&title="+n};break;case"linkedin":a[e[r]]={title:"LinkedIn",shareUrl:"https://www.linkedin.com/shareArticle?mini=true&url="+t};break;case"mix":a[e[r]]={title:"Mix",shareUrl:"https://mix.com/add?url="+t};break;case"whatsapp":a[e[r]]={title:"WhatsApp",shareUrl:"whatsapp://send?text="+t};break;case"telegram":a[e[r]]={title:"Telegram",shareUrl:"https://t.me/share/url?url="+t+"&text="+n}}r+=1}return a}(),t=[];for(var n in e)e.hasOwnProperty(n)&&("embed"===n?t.push(r.createElement("div",{key:"share-"+n,className:"sh-option share-"+n+"-opt"},r.createElement("button",{className:"sh-option change-page","data-page-id":"shareEmbed"},r.createElement("span",null,r.createElement("i",{className:"material-icons"},"code")),r.createElement("span",null,"Embed")))):"whatsapp"===n?t.push(r.createElement("div",{key:"share-"+n,className:"sh-option share-"+n},r.createElement("a",{href:e[n].shareUrl,title:"",target:"_blank","data-action":"share/whatsapp/share",rel:"noreferrer"},r.createElement("span",null),r.createElement("span",null,e[n].title)))):"email"===n?t.push(r.createElement("div",{key:"share-email",className:"sh-option share-email"},r.createElement("a",{href:e[n].shareUrl,title:""},r.createElement("span",null,r.createElement("i",{className:"material-icons"},"email")),r.createElement("span",null,e[n].title)))):t.push(r.createElement("div",{key:"share-"+n,className:"sh-option share-"+n},r.createElement("a",{href:e[n].shareUrl,title:"",target:"_blank",rel:"noreferrer"},r.createElement("span",null),r.createElement("span",null,e[n].title)))));return t}()),1)[0];function g(){y(xe())}function v(){setTimeout((function(){m.PageActions.addNotification("Link copied to clipboard","clipboardLinkCopy")}),100)}function b(){l.scrollToCurrentSlide(),d({prev:l.hasPreviousSlide(),next:l.hasNextSlide()})}return(0,r.useEffect)((function(){s(new ke.Z(n.current,".sh-option"))}),[h]),(0,r.useEffect)((function(){l&&(l.updateDataStateOnResize(h.length,!0,!0),b())}),[f,l]),(0,r.useEffect)((function(){return o.PageStore.on("window_resize",g),o.MediaPageStore.on("copied_media_link",v),function(){o.PageStore.removeListener("window_resize",g),o.MediaPageStore.removeListener("copied_media_link",v),s(null)}}),[]),r.createElement("div",{ref:t,style:null!==f.maxPopupWidth?{maxWidth:f.maxPopupWidth+"px"}:null},r.createElement("div",{className:"scrollable-content",style:null!==f.maxFormContentHeight?{maxHeight:f.maxFormContentHeight+"px"}:null},r.createElement("div",{className:"share-popup-title"},"Share media"),h.length?r.createElement("div",{className:"share-options"},c.prev?r.createElement(Oe,{onClick:function(){l.previousSlide(),b()}}):null,r.createElement("div",{ref:n,className:"share-options-inner"},h),c.next?r.createElement(Ne,{onClick:function(){l.nextSlide(),b()}}):null):null),r.createElement("div",{className:"copy-field"},r.createElement("div",null,r.createElement("input",{type:"text",readOnly:!0,value:o.MediaPageStore.get("media-url")}),r.createElement("button",{onClick:function(){m.MediaPageActions.copyShareLink(t.current.querySelector(".copy-field input"))}},"COPY"))))}function Ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function De(){return{shareOptions:r.createElement("div",{className:"popup-fullscreen"},r.createElement(U.PopupMain,null,r.createElement("span",{className:"popup-fullscreen-overlay"}),r.createElement(Ie,null)))}}function Ue(e){var t,n=Ve((0,D.usePopup)(),3),a=n[0],i=n[1],o=n[2],l=Ve((0,r.useState)("shareOptions"),2),s=l[0],u=l[1];return r.createElement("div",{className:"share"},r.createElement(o,{contentRef:a},r.createElement("button",null,r.createElement(U.CircleIconButton,{type:"span"},r.createElement(U.MaterialIcon,{type:"share"})),r.createElement("span",null,"SHARE"))),r.createElement(i,{contentRef:a,hideCallback:function(){u("shareOptions")}},r.createElement(U.NavigationContentApp,{initPage:s,pageChangeSelector:".change-page",pageIdSelectorAttr:"data-page-id",pages:e.isVideo?(t=function(){a.current.toggle()},Te(Te({},De()),{},{shareEmbed:r.createElement("div",{className:"popup-fullscreen share-embed-popup"},r.createElement(U.PopupMain,null,r.createElement("span",{className:"popup-fullscreen-overlay"}),r.createElement(_e,{triggerPopupClose:t})))})):De(),focusFirstItemOnPageChange:!1,pageChangeCallback:function(e){u(e)}})))}function qe(e){return r.createElement("div",{className:"download hidden-only-in-small"},r.createElement("a",{href:e.link,target:"_blank",download:e.title,title:"Download",rel:"noreferrer"},r.createElement(U.CircleIconButton,{type:"span"},r.createElement(U.MaterialIcon,{type:"arrow_downward"})),r.createElement("span",null,"DOWNLOAD")))}function Fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Be(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ze(){var e,t,n=o.MediaPageStore.get("media-data"),a=(n.title,n.encodings_info),r={};for(e in a)if(a.hasOwnProperty(e)&&Object.keys(a[e]).length)for(t in a[e])a[e].hasOwnProperty(t)&&"success"===a[e][t].status&&100===a[e][t].progress&&(r[a[e][t].title]={text:e+" - "+t.toUpperCase()+" ("+a[e][t].size+")",link:(0,p.formatInnerLink)(a[e][t].url,i.SiteContext._currentValue.url),linkAttr:{target:"_blank",download:n.title+"_"+e+"_"+t.toUpperCase()}});return r.original_media_url={text:"Original file ("+n.size+")",link:(0,p.formatInnerLink)(n.original_media_url,i.SiteContext._currentValue.url),linkAttr:{target:"_blank",download:n.title}},Object.values(r)}function He(e){var t=Fe((0,D.usePopup)(),3),n=t[0],a=t[1],i=t[2],o=Fe((0,r.useState)("main"),2),l=o[0];return o[1],r.createElement("div",{className:"video-downloads hidden-only-in-small"},r.createElement(i,{contentRef:n},r.createElement("button",null,r.createElement(U.CircleIconButton,{type:"span"},r.createElement(U.MaterialIcon,{type:"arrow_downward"})),r.createElement("span",null,"DOWNLOAD"))),r.createElement("div",{className:"nav-page-"+l},r.createElement(a,{contentRef:n},r.createElement(U.NavigationContentApp,{pageChangeCallback:null,initPage:"main",focusFirstItemOnPageChange:!1,pages:{main:r.createElement("div",{className:"main-options"},r.createElement(U.PopupMain,null,r.createElement(U.NavigationMenuList,{items:ze()})))},pageChangeSelector:".change-page",pageIdSelectorAttr:"data-page-id"}))))}function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Qe(e,t){return(Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Je(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?Ye(e):t}function Ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}qe.propTypes={link:u().string.isRequired,title:u().string.isRequired};var Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t)}(u,e);var t,n,a,l,s=(a=u,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ge(a);if(l){var n=Ge(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Je(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).state={likedMedia:o.MediaPageStore.get("user-liked-media"),dislikedMedia:o.MediaPageStore.get("user-disliked-media")},t.downloadLink="video"!==o.MediaPageStore.get("media-type")?(0,p.formatInnerLink)(o.MediaPageStore.get("media-original-url"),i.SiteContext._currentValue.url):null,t.updateStateValues=t.updateStateValues.bind(Ye(t)),t}return t=u,(n=[{key:"componentDidMount",value:function(){o.MediaPageStore.on("liked_media",this.updateStateValues),o.MediaPageStore.on("unliked_media",this.updateStateValues),o.MediaPageStore.on("disliked_media",this.updateStateValues),o.MediaPageStore.on("undisliked_media",this.updateStateValues);var e=document.querySelectorAll("[data-tooltip]");e.length&&e.forEach((function(e){return function(e){var t=document.body,n=document.createElement("span");function a(){var t=e.getBoundingClientRect();n.style.top=t.top-(0+n.offsetHeight)+"px",n.style.left=t.left+"px"}n.innerText=e.getAttribute("data-tooltip"),n.setAttribute("class","tooltip"),e.removeAttribute("data-tooltip"),e.addEventListener("mouseenter",(function(){var r=e.getBoundingClientRect();t.appendChild(n),n.style.top=r.top-(0+n.offsetHeight)+"px",n.style.left=r.left+"px",document.addEventListener("scroll",a)})),e.addEventListener("mouseleave",(function(){t.removeChild(n),n.style.top="",n.style.left="",document.removeEventListener("scroll",a)}))}(e)}))}},{key:"updateStateValues",value:function(){this.setState({likedMedia:o.MediaPageStore.get("user-liked-media"),dislikedMedia:o.MediaPageStore.get("user-disliked-media")})}},{key:"mediaCategories",value:function(e){if(void 0===this.props.categories||null===this.props.categories||!this.props.categories.length)return null;for(var t=0,n=[];t<this.props.categories.length;)n.push(r.createElement("span",{key:t},r.createElement("a",{href:(0,p.formatInnerLink)(this.props.categories[t].url,i.SiteContext._currentValue.url),title:this.props.categories[t].title},this.props.categories[t].title))),t+=1;return r.createElement("div",{className:"media-under-title-categories"+(e?" over-title":"")},n)}},{key:"render",value:function(){var e=o.PageStore.get("config-options").pages.media.displayViews&&void 0!==this.props.views,t=o.MediaPageStore.get("media-data").state,n="";switch(t){case"private":n="The site admins have to make its access public";break;case"unlisted":n="The site admins have to make it appear on listings"}return r.createElement("div",{className:"media-title-banner"},e&&o.PageStore.get("config-options").pages.media.categoriesWithTitle?this.mediaCategories(!0):null,void 0!==this.props.title?r.createElement("h1",null,this.props.title):null,"public"!==t?r.createElement("div",{className:"media-labels-area"},r.createElement("div",{className:"media-labels-area-inner"},r.createElement("span",{className:"media-label-state"},r.createElement("span",null,t)),r.createElement("span",{className:"helper-icon","data-tooltip":n},r.createElement("i",{className:"material-icons"},"help_outline")))):null,r.createElement("div",{className:"media-views-actions"+(this.state.likedMedia?" liked-media":"")+(this.state.dislikedMedia?" disliked-media":"")},!e&&o.PageStore.get("config-options").pages.media.categoriesWithTitle?this.mediaCategories():null,e?r.createElement("div",{className:"media-views"},(0,p.formatViewsNumber)(this.props.views,!0)," ",1>=this.props.views?"view":"views"):null,r.createElement("div",{className:"media-actions"},r.createElement("div",null,i.MemberContext._currentValue.can.likeMedia?r.createElement(ee,null):null,i.MemberContext._currentValue.can.dislikeMedia?r.createElement(K,null):null,i.MemberContext._currentValue.can.shareMedia?r.createElement(Ue,{isVideo:!1}):null,!i.MemberContext._currentValue.is.anonymous&&i.MemberContext._currentValue.can.saveMedia&&-1<i.PlaylistsContext._currentValue.mediaTypes.indexOf(o.MediaPageStore.get("media-type"))?r.createElement(he,null):null,this.props.allowDownload&&i.MemberContext._currentValue.can.downloadMedia?this.downloadLink?r.createElement(qe,{link:this.downloadLink,title:this.props.title}):r.createElement(He,null):null,r.createElement(se,{allowDownload:this.props.allowDownload})))))}}])&&$e(t.prototype,n),u}(r.PureComponent);function Xe(e){return(Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function et(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function tt(e,t){return(tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nt(e,t){return!t||"object"!==Xe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Ke.propTypes={allowDownload:u().bool.isRequired},Ke.defaultProps={allowDownload:!1};var rt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tt(e,t)}(u,e);var t,n,a,l,s=(a=u,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=at(a);if(l){var n=at(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return nt(this,e)});function u(){return Ze(this,u),s.apply(this,arguments)}return t=u,(n=[{key:"render",value:function(){var e=o.PageStore.get("config-options").pages.media.displayViews&&void 0!==this.props.views,t=o.MediaPageStore.get("media-data").state,n="";switch(t){case"private":n="The site admins have to make its access public";break;case"unlisted":n="The site admins have to make it appear on listings"}return r.createElement("div",{className:"media-title-banner"},e&&o.PageStore.get("config-options").pages.media.categoriesWithTitle?this.mediaCategories(!0):null,void 0!==this.props.title?r.createElement("h1",null,this.props.title):null,"public"!==t?r.createElement("div",{className:"media-labels-area"},r.createElement("div",{className:"media-labels-area-inner"},r.createElement("span",{className:"media-label-state"},r.createElement("span",null,t)),r.createElement("span",{className:"helper-icon","data-tooltip":n},r.createElement("i",{className:"material-icons"},"help_outline")))):null,r.createElement("div",{className:"media-views-actions"+(this.state.likedMedia?" liked-media":"")+(this.state.dislikedMedia?" disliked-media":"")},!e&&o.PageStore.get("config-options").pages.media.categoriesWithTitle?this.mediaCategories():null,e?r.createElement("div",{className:"media-views"},(0,p.formatViewsNumber)(this.props.views,!0)," ",1>=this.props.views?"view":"views"):null,r.createElement("div",{className:"media-actions"},r.createElement("div",null,i.MemberContext._currentValue.can.likeMedia?r.createElement(ee,null):null,i.MemberContext._currentValue.can.dislikeMedia?r.createElement(K,null):null,i.MemberContext._currentValue.can.shareMedia?r.createElement(Ue,{isVideo:!0}):null,!i.MemberContext._currentValue.is.anonymous&&i.MemberContext._currentValue.can.saveMedia&&-1<i.PlaylistsContext._currentValue.mediaTypes.indexOf(o.MediaPageStore.get("media-type"))?r.createElement(he,null):null,i.MemberContext._currentValue.can.addToTechniques?r.createElement(Pe,null):null,this.props.allowDownload&&i.MemberContext._currentValue.can.downloadMedia?this.downloadLink?r.createElement(qe,{link:this.downloadLink,title:this.props.title}):r.createElement(He,null):null,r.createElement(se,{allowDownload:this.props.allowDownload})))))}}])&&et(t.prototype,n),u}(Ke);function it(e){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ot(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function st(e,t){return!t||"object"!==it(t)&&"function"!=typeof t?ut(e):t}function ut(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yt(e,t){return!t||"object"!==dt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ht(e){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(s,e);var t,n,a,i,l=(a=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ht(a);if(i){var n=ht(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return yt(this,e)});function s(){return pt(this,s),l.apply(this,arguments)}return t=s,(n=[{key:"render",value:function(){var e,t,n,a,i,l,s=!1;return this.state.videoLoaded&&(s=void 0===(s=o.MediaPageStore.get("media-data").allow_download)||!!s,e=o.MediaPageStore.get("media-data").views,t=o.MediaPageStore.get("media-data").categories_info,n=o.MediaPageStore.get("media-data").title,a={name:o.MediaPageStore.get("media-data").author_name,url:o.MediaPageStore.get("media-data").author_profile,thumb:o.MediaPageStore.get("media-author-thumbnail-url")},i=o.MediaPageStore.get("media-data").add_date,l=o.MediaPageStore.get("media-data").description),this.state.videoLoaded?r.createElement("div",{className:"viewer-info"},r.createElement("div",{className:"viewer-info-inner"},r.createElement(rt,{title:n,views:e,categories:t,allowDownload:s}),r.createElement(J,{author:a,published:i,description:l}))):null}}])&&mt(t.prototype,n),s}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(s,e);var t,n,a,i,l=(a=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ct(a);if(i){var n=ct(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return st(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=l.call(this,e)).state={videoLoaded:!1},t.onVideoLoad=t.onVideoLoad.bind(ut(t)),o.MediaPageStore.on("loaded_media_data",t.onVideoLoad),t}return t=s,(n=[{key:"onVideoLoad",value:function(){this.setState({videoLoaded:!0})}},{key:"render",value:function(){var e,t,n,a,i,l,s=!1;return this.state.videoLoaded&&(s=void 0===(s=o.MediaPageStore.get("media-data").allow_download)||!!s,e=o.MediaPageStore.get("media-data").views,t=o.MediaPageStore.get("media-data").categories_info,n=o.MediaPageStore.get("media-data").title,a={name:o.MediaPageStore.get("media-data").author_name,url:o.MediaPageStore.get("media-data").author_profile,thumb:o.MediaPageStore.get("media-author-thumbnail-url")},i=o.MediaPageStore.get("media-data").add_date,l=o.MediaPageStore.get("media-data").description),this.state.videoLoaded?r.createElement("div",{className:"viewer-info"},r.createElement("div",{className:"viewer-info-inner"},r.createElement(Ke,{title:n,views:e,categories:t,allowDownload:s}),r.createElement(J,{author:a,published:i,description:l}))):null}}])&&ot(t.prototype,n),s}(r.PureComponent));function vt(e){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function St(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function wt(e,t){return(wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pt(e,t){return!t||"object"!==vt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Et(e){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(s,e);var t,n,a,i,l=(a=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Et(a);if(i){var n=Et(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Pt(this,e)});function s(){return bt(this,s),l.apply(this,arguments)}return t=s,(n=[{key:"render",value:function(){return r.createElement("div",{className:"viewer-container",key:"viewer-container-error"},r.createElement("div",{className:"player-container player-container-error"},r.createElement("div",{className:"player-container-inner"},r.createElement("div",{className:"error-container"},r.createElement("div",{className:"error-container-inner"},r.createElement("span",{className:"icon-wrap"},r.createElement("i",{className:"material-icons"},"error_outline")),r.createElement("span",{className:"msg-wrap"},o.MediaPageStore.get("media-load-error-message")))))))}}])&&St(t.prototype,n),s}(r.PureComponent),_t=n(7777);function kt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ct(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function At(){var e=o.MediaPageStore.get("media-data");return e&&e.related_media&&e.related_media.length?e.related_media[0]:null}function Nt(e){var t=kt((0,r.useState)(At()),2),n=t[0],a=t[1],i=kt((0,r.useState)(o.PageStore.get("media-auto-play")),2),l=i[0],s=i[1];function u(){s(o.PageStore.get("media-auto-play"))}function c(){a(At())}return(0,r.useEffect)((function(){return o.MediaPageStore.on("loaded_media_data",c),o.PageStore.on("switched_media_auto_play",u),function(){o.MediaPageStore.removeListener("loaded_media_data",c),o.PageStore.removeListener("switched_media_auto_play",u)}}),[]),n?r.createElement("div",{className:"auto-play"},r.createElement("div",{className:"auto-play-header"},r.createElement("div",{className:"next-label"},"Up next"),r.createElement("div",{className:"auto-play-option"},r.createElement("label",{className:"checkbox-label right-selectbox",tabIndex:0,onKeyPress:function(e){0===e.keyCode&&m.PageActions.toggleMediaAutoPlay()}},"AUTOPLAY",r.createElement("span",{className:"checkbox-switcher-wrap"},r.createElement("span",{className:"checkbox-switcher"},r.createElement("input",{type:"checkbox",tabIndex:-1,checked:l,onChange:m.PageActions.toggleMediaAutoPlay})))))),r.createElement(_t.s,{className:"items-list-hor",items:[n],pageItems:1,maxItems:1,singleLinkContent:!0,horizontalItemsOrientation:!0,hideDate:!0,hideViews:!o.PageStore.get("config-media-item").displayViews,hideAuthor:!o.PageStore.get("config-media-item").displayAuthor})):null}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function It(e){var t=Ot((0,r.useState)(c()),2),n=t[0],a=t[1],i=Ot((0,r.useState)(null),2),l=i[0],s=i[1];function u(){s(o.MediaPageStore.get("media-type")),a(c())}function c(){var e=o.MediaPageStore.get("media-data");return null!=e&&void 0!==e.related_media&&e.related_media.length?e.related_media:null}return(0,r.useEffect)((function(){return o.MediaPageStore.on("loaded_media_data",u),function(){return o.MediaPageStore.removeListener("loaded_media_data",u)}}),[]),n&&n.length?r.createElement(_t.s,{className:"items-list-hor",items:!e.hideFirst||"video"!==l&&"audio"!==l?n:n.slice(1),pageItems:o.PageStore.get("config-options").pages.media.related.initialSize,singleLinkContent:!0,horizontalItemsOrientation:!0,hideDate:!0,hideViews:!o.PageStore.get("config-media-item").displayViews,hideAuthor:!o.PageStore.get("config-media-item").displayAuthor}):null}function Vt(e){return r.createElement(_t.s,{className:"items-list-hor",pageItems:9999,maxItems:9999,items:e.items,hideDate:!0,hideViews:!0,hidePlaylistOrderNumber:!1,horizontalItemsOrientation:!0,inPlaylistView:!0,singleLinkContent:!0,playlistActiveItem:e.playlistActiveItem})}function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jt(e,t){return!t||"object"!==Rt(t)&&"function"!=typeof t?Dt(e):t}function Dt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}It.propTypes={hideFirst:u().bool},It.defaultProps={hideFirst:!0},Vt.propTypes={items:u().array.isRequired,playlistActiveItem:p.PositiveIntegerOrZero},Vt.defaultProps={playlistActiveItem:1};var qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(u,e);var t,n,a,l,s=(a=u,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ut(a);if(l){var n=Ut(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return jt(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).state={expanded:!0,loopRepeat:o.PlaylistViewStore.get("enabled-loop"),shuffle:o.PlaylistViewStore.get("enabled-shuffle"),savedPlaylist:o.PlaylistViewStore.get("saved-playlist-loop"),title:e.playlistData.title,link:e.playlistData.url,authorName:e.playlistData.user,authorLink:i.LinksContext._currentValue.home+"/user/"+e.playlistData.user,activeItem:e.activeItem,totalMedia:e.playlistData.media_count,items:e.playlistData.playlist_media},t.onHeaderClick=t.onHeaderClick.bind(Dt(t)),t.onLoopClick=t.onLoopClick.bind(Dt(t)),t.onShuffleClick=t.onShuffleClick.bind(Dt(t)),t.onSaveClick=t.onSaveClick.bind(Dt(t)),t.onLoopRepeatUpdate=t.onLoopRepeatUpdate.bind(Dt(t)),t.onShuffleUpdate=t.onShuffleUpdate.bind(Dt(t)),t.onPlaylistSaveUpdate=t.onPlaylistSaveUpdate.bind(Dt(t)),o.PlaylistViewStore.on("loop-repeat-updated",t.onLoopRepeatUpdate),o.PlaylistViewStore.on("shuffle-updated",t.onShuffleUpdate),o.PlaylistViewStore.on("saved-updated",t.onPlaylistSaveUpdate),t}return t=u,(n=[{key:"onHeaderClick",value:function(e){this.setState({expanded:!this.state.expanded})}},{key:"onLoopClick",value:function(){m.PlaylistViewActions.toggleLoop()}},{key:"onShuffleClick",value:function(){m.PlaylistViewActions.toggleShuffle()}},{key:"onSaveClick",value:function(){m.PlaylistViewActions.toggleSave()}},{key:"onShuffleUpdate",value:function(){var e=this;this.setState({shuffle:o.PlaylistViewStore.get("enabled-shuffle")},(function(){e.state.shuffle?m.PageActions.addNotification("Playlist shuffle is on","shuffle-on"):m.PageActions.addNotification("Playlist shuffle is off","shuffle-off")}))}},{key:"onLoopRepeatUpdate",value:function(){var e=this;this.setState({loopRepeat:o.PlaylistViewStore.get("enabled-loop")},(function(){e.state.loopRepeat?m.PageActions.addNotification("Playlist loop is on","loop-on"):m.PageActions.addNotification("Playlist loop is off","loop-off")}))}},{key:"onPlaylistSaveUpdate",value:function(){var e=this;this.setState({savedPlaylist:o.PlaylistViewStore.get("saved-playlist")},(function(){e.state.savedPlaylist?m.PageActions.addNotification("Added to playlists library","added-to-playlists-lib"):m.PageActions.addNotification("Removed from playlists library","removed-from-playlists-lib")}))}},{key:"render",value:function(){return r.createElement("div",{className:"playlist-view-wrap"},r.createElement("div",{className:"playlist-view"+(this.state.expanded?" playlist-expanded-view":"")},r.createElement("div",{className:"playlist-header"},r.createElement("div",{className:"playlist-title"},r.createElement("a",{href:this.state.link,title:this.state.title},this.state.title)),r.createElement("div",{className:"playlist-meta"},r.createElement("span",null,r.createElement("a",{href:this.state.authorLink,title:this.state.authorName},this.state.authorName)),"-",r.createElement("span",{className:"counter"},this.state.activeItem," / ",this.state.totalMedia)),r.createElement(U.CircleIconButton,{className:"toggle-playlist-view",onClick:this.onHeaderClick},this.state.expanded?r.createElement("i",{className:"material-icons"},"keyboard_arrow_up"):r.createElement("i",{className:"material-icons"},"keyboard_arrow_down"))),this.state.expanded?r.createElement("div",{className:"playlist-actions"},r.createElement(U.CircleIconButton,{className:this.state.loopRepeat?"active":"",onClick:this.onLoopClick,title:"Loop playlist"},r.createElement("i",{className:"material-icons"},"repeat"))):null,this.state.expanded&&this.state.items.length?r.createElement("div",{className:"playlist-media"},r.createElement(Vt,{items:this.state.items,playlistActiveItem:this.state.activeItem})):null))}}])&&Lt(t.prototype,n),u}(r.PureComponent);function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function zt(e,t){return(zt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ht(e,t){return!t||"object"!==Ft(t)&&"function"!=typeof t?Wt(e):t}function Wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $t(e){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}qt.propTypes={playlistData:u().object.isRequired,activeItem:p.PositiveIntegerOrZero},qt.defaultProps={};var Qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zt(e,t)}(s,e);var t,n,a,i,l=(a=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$t(a);if(i){var n=$t(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ht(this,e)});function s(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=l.call(this,e)).state={playlistData:e.playlistData,isPlaylistPage:!!e.playlistData,activeItem:0,mediaType:o.MediaPageStore.get("media-type")},e.playlistData)for(var n=0;n<e.playlistData.playlist_media.length;){if(e.mediaId===e.playlistData.playlist_media[n].friendly_token){t.state.activeItem=n+1;break}n+=1}return t.onMediaLoad=t.onMediaLoad.bind(Wt(t)),t}return t=s,(n=[{key:"componentDidMount",value:function(){o.MediaPageStore.on("loaded_media_data",this.onMediaLoad)}},{key:"onMediaLoad",value:function(){this.setState({mediaType:o.MediaPageStore.get("media-type")})}},{key:"render",value:function(){return r.createElement("div",{className:"viewer-sidebar"},this.state.isPlaylistPage?r.createElement(qt,{activeItem:this.state.activeItem,playlistData:this.props.playlistData}):"video"===this.state.mediaType||"audio"===this.state.mediaType?r.createElement(Nt,null):null,r.createElement(It,{hideFirst:!this.state.isPlaylistPage}))}}])&&Bt(t.prototype,n),s}(r.PureComponent);function Jt(e){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Gt(e,t){return(Gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kt(e,t){return!t||"object"!==Jt(t)&&"function"!=typeof t?Xt(e):t}function Xt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zt(e){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var en=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gt(e,t)}(s,e);var t,n,a,i,l=(a=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Zt(a);if(i){var n=Zt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Kt(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=l.call(this,e,"media")).state={wideLayout:1216<=window.innerWidth,mediaLoaded:!1,mediaLoadFailed:!1,isVideoMedia:!1,theaterMode:!1,pagePlaylistLoaded:!1,pagePlaylistData:o.MediaPageStore.get("playlist-data")},t.onWindowResize=t.onWindowResize.bind(Xt(t)),t.onMediaLoad=t.onMediaLoad.bind(Xt(t)),t.onMediaLoadError=t.onMediaLoadError.bind(Xt(t)),t.onPagePlaylistLoad=t.onPagePlaylistLoad.bind(Xt(t)),o.MediaPageStore.on("loaded_media_data",t.onMediaLoad),o.MediaPageStore.on("loaded_media_error",t.onMediaLoadError),o.MediaPageStore.on("loaded_page_playlist_data",t.onPagePlaylistLoad),t}return t=s,(n=[{key:"componentDidMount",value:function(){m.MediaPageActions.loadMediaData(),o.PageStore.on("window_resize",this.onWindowResize)}},{key:"onWindowResize",value:function(){this.setState({wideLayout:1216<=window.innerWidth})}},{key:"onPagePlaylistLoad",value:function(){this.setState({pagePlaylistLoaded:!0,pagePlaylistData:o.MediaPageStore.get("playlist-data")})}},{key:"onMediaLoad",value:function(){var e="video"===o.MediaPageStore.get("media-type");e?(this.onViewerModeChange=this.onViewerModeChange.bind(this),o.VideoViewerStore.on("changed_viewer_mode",this.onViewerModeChange),this.setState({mediaLoaded:!0,isVideoMedia:e,theaterMode:o.VideoViewerStore.get("in-theater-mode")})):this.setState({mediaLoaded:!0,isVideoMedia:e})}},{key:"onViewerModeChange",value:function(){this.setState({theaterMode:o.VideoViewerStore.get("in-theater-mode")})}},{key:"onMediaLoadError",value:function(e){this.setState({mediaLoadFailed:!0})}},{key:"pageContent",value:function(){var e="cf viewer-section"+(this.state.theaterMode?" theater-mode":" viewer-wide"),t="viewer-section-nested"+(this.state.theaterMode?" viewer-section":"");return this.state.mediaLoadFailed?r.createElement("div",{className:e},r.createElement(Mt,null)):r.createElement("div",{className:e},[r.createElement("div",{className:"viewer-container",key:"viewer-container"},this.state.mediaLoaded&&this.state.pagePlaylistLoaded?this.viewerContainerContent(o.MediaPageStore.get("media-data")):null),r.createElement("div",{key:"viewer-section-nested",className:t},!this.state.wideLayout||this.state.isVideoMedia&&this.state.theaterMode?[r.createElement(gt,{key:"viewer-info"}),this.state.pagePlaylistLoaded?r.createElement(Qt,{key:"viewer-sidebar",mediaId:o.MediaPageStore.get("media-id"),playlistData:o.MediaPageStore.get("playlist-data")}):null]:[this.state.pagePlaylistLoaded?r.createElement(Qt,{key:"viewer-sidebar",mediaId:o.MediaPageStore.get("media-id"),playlistData:o.MediaPageStore.get("playlist-data")}):null,r.createElement(gt,{key:"viewer-info"})])])}}])&&Yt(t.prototype,n),s}(n(8204).T);function tn(e){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function an(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function on(e,t){return!t||"object"!==tn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ln(e){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}if(window.MediaCMS.site.devEnv){var sn=function(){var e=null,t=null,n=window.location.search.split("?")[1];return n&&n.split("&").forEach((function(n){0===n.indexOf("m=")?e=n.split("m=")[1]:0===n.indexOf("pl=")&&(t=n.split("pl=")[1])})),{mediaId:e,playlistId:t}}(),un=sn.mediaId,cn=sn.playlistId;un&&(window.MediaCMS.mediaId=un),cn&&(window.MediaCMS.playlistId=cn)}var dn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rn(e,t)}(c,e);var t,n,a,s,u=(a=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ln(a);if(s){var n=ln(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return on(this,e)});function c(){return nn(this,c),u.apply(this,arguments)}return t=c,(n=[{key:"viewerContainerContent",value:function(e){switch(o.MediaPageStore.get("media-type")){case"video":return r.createElement(i.SiteConsumer,null,(function(t){return r.createElement(T,{data:e,siteUrl:t.url,inEmbed:!1})}));case"audio":return r.createElement(E,null);case"image":return r.createElement(_,null);case"pdf":return r.createElement(k,null)}return r.createElement(l,null)}}])&&an(t.prototype,n),c}(en);(0,a.X)("page-media",dn)},4234:function(e,t,n){n.d(t,{CircleIconButton:function(){return a.M},MaterialIcon:function(){return r.O},NavigationContentApp:function(){return i.o},NavigationMenuList:function(){return o.S},Notifications:function(){return l.T},NumericInputWithUnit:function(){return s.O},PopupMain:function(){return u.W8},PopupTop:function(){return u.HF},SpinnerLoader:function(){return c.i},UserThumbnail:function(){return d.q}});var a=n(7714),r=(n(7446),n(2915),n(2299)),i=n(2917),o=n(5671),l=n(2436),s=n(5517),u=n(940),c=n(6309),d=n(6142)},5517:function(e,t,n){n.d(t,{O:function(){return s}}),n(2004),n(8407),n(6394),n(8288),n(5677),n(2129),n(4655),n(288),n(4458),n(3675);var a=n(5466),r=n(3074),i=n.n(r);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function s(e){var t=(0,a.useRef)(null),n=(0,a.useRef)(null),r=o((0,a.useState)(null),2),i=r[0],l=r[1],s=o((0,a.useState)(null),2),u=s[0],c=s[1];return(0,a.useEffect)((function(){l(function(e,t,n){if(void 0!==e){var a;return a=void 0!==t&&t>e?t:e,void 0!==n&&n<a?n:a}return void 0!==t?t:void 0!==n?n:void 0}(0+e.defaultValue,e.minValue,e.maxValue)),c(function(e,t){if(!t||!t.length)return null;for(var n=0;n<t.length;){if(void 0!==t[n].key&&e===t[n].key)return t[n].key;n+=1}return t[0].key}(e.defaultUnit,e.units))})),a.createElement("div",{className:"num-value-unit"},void 0!==e.label?a.createElement("span",{className:"label"},e.label):null,a.createElement("input",{ref:t,className:"value-input",type:"number",value:null!==i?i:"",min:void 0!==e.minValue?e.minValue:null,max:void 0!==e.maxValue?e.maxValue:null,onChange:function(){l(t.current.value),void 0!==e.valueCallback&&e.valueCallback(t.current.value)}}),a.createElement("select",{ref:n,className:"value-unit",onChange:function(){c(n.current.value),void 0!==e.unitCallback&&e.unitCallback(n.current.value)},value:null!==u?u:""},function(){if(!e.units.length)return null;for(var t=[],n=0;n<e.units.length;)void 0!==e.units[n].key&&t.push(a.createElement("option",{key:e.units[n].key,value:e.units[n].key},void 0!==e.units[n].label?e.units[n].label:e.units[n].key)),n+=1;return t}()))}s.propTypes={label:i().string,units:i().array.isRequired,defaultUnit:i().string,defaultValue:i().number,minValue:i().number,maxValue:i().number,valueCallback:i().func,unitCallback:i().func}},6309:function(e,t,n){n.d(t,{i:function(){return o}});var a=n(5466),r=n(3074),i=n.n(r);function o(e){var t="spinner-loader";switch(e.size){case"tiny":case"x-small":case"small":case"large":case"x-large":t+=" "+e.size}return a.createElement("div",{className:t},a.createElement("svg",{className:"circular",viewBox:"25 25 50 50"},a.createElement("circle",{className:"path",cx:"50",cy:"50",r:"20",fill:"none",strokeWidth:"1.5",strokeMiterlimit:"10"})))}o.propTypes={size:i().oneOf(["tiny","x-small","small","medium","large","x-large"])},o.defaultProps={size:"medium"}},6142:function(e,t,n){n.d(t,{q:function(){return u}});var a=n(5466),r=n(3074),i=n.n(r),o=n(9747),l=n(7714),s=n(2299);function u(e){var t=(0,o.useUser)().thumbnail,n={"aria-label":"Account profile photo that opens list of options and settings pages links",className:"thumbnail"};switch(e.isButton?void 0!==e.onClick&&(n.onClick=e.onClick):n.type="span",e.size){case"small":case"large":n.className+=" "+e.size+"-thumb"}return a.createElement(l.M,n,t?a.createElement("img",{src:t,alt:""}):a.createElement(s.O,{type:"person"}))}u.propTypes={isButton:i().bool,size:i().oneOf(["small","medium","large"]),onClick:i().func},u.defaultProps={isButton:!1,size:"medium"}},8727:function(e,t,n){n.d(t,{hJ:function(){return c},Y7:function(){return d}}),n(2322),n(3296),n(6394),n(4669),n(717);var a=n(5466),r=n(3074),i=n.n(r),o=n(137),l=n.n(o),s=n(8009),u=n.n(s);function c(e){return a.createElement("div",{className:"error-container"},a.createElement("div",{className:"error-container-inner"},a.createElement("span",{className:"icon-wrap"},a.createElement("i",{className:"material-icons"},"error_outline")),a.createElement("span",{className:"msg-wrap"},e.errorMessage)))}function d(e){var t=(0,a.useRef)(null),n=null,r={playerVolume:e.playerVolume,playerSoundMuted:e.playerSoundMuted,videoQuality:e.videoQuality,videoPlaybackSpeed:e.videoPlaybackSpeed,inTheaterMode:e.inTheaterMode};function i(){void 0!==e.onClickNextCallback&&e.onClickNextCallback()}function o(){void 0!==e.onClickPreviousCallback&&e.onClickPreviousCallback()}function s(t){r.playerVolume!==t.volume&&(r.playerVolume=t.volume),r.playerSoundMuted!==t.soundMuted&&(r.playerSoundMuted=t.soundMuted),r.videoQuality!==t.quality&&(r.videoQuality=t.quality),r.videoPlaybackSpeed!==t.playbackSpeed&&(r.videoPlaybackSpeed=t.playbackSpeed),r.inTheaterMode!==t.theaterMode&&(r.inTheaterMode=t.theaterMode),void 0!==e.onStateUpdateCallback&&e.onStateUpdateCallback(t)}function c(){if(null===n&&null===e.errorMessage&&(e.inEmbed||(window.removeEventListener("focus",c),document.removeEventListener("visibilitychange",c)),t.current)){e.inEmbed||t.current.focus();var a,d,p,m={on:!1};if(void 0!==e.subtitlesInfo&&null!==e.subtitlesInfo&&e.subtitlesInfo.length){m.languages=[];for(var f=0;f<e.subtitlesInfo.length;)void 0!==e.subtitlesInfo[f].src&&void 0!==e.subtitlesInfo[f].srclang&&void 0!==e.subtitlesInfo[f].label&&m.languages.push({src:(a=e.subtitlesInfo[f].src,d=e.siteUrl,p=void 0,p=l()(a,{}),""!==p.origin&&"null"!==p.origin&&p.origin||(p=l()(d+"/"+a.replace(/^\//g,""),{})),p.toString()),srclang:e.subtitlesInfo[f].srclang,label:e.subtitlesInfo[f].label}),f+=1;m.languages.length&&(m.on=!0)}n=new(u())(t.current,{enabledTouchControls:!0,sources:e.sources,poster:e.poster,autoplay:e.enableAutoplay,bigPlayButton:!0,controlBar:{theaterMode:e.hasTheaterMode,pictureInPicture:!1,next:!!e.hasNextLink,previous:!!e.hasPreviousLink},subtitles:m,cornerLayers:e.cornerLayers,videoPreviewThumb:e.previewSprite},{volume:r.playerVolume,soundMuted:r.playerSoundMuted,theaterMode:r.inTheaterMode,theSelectedQuality:void 0,theSelectedPlaybackSpeed:r.videoPlaybackSpeed||1},e.info,[.25,.5,.75,1,1.25,1.5,1.75,2],s,i,o),void 0!==e.onPlayerInitCallback&&e.onPlayerInitCallback(n,t.current)}}return r.playerVolume=null===r.playerVolume?1:Math.max(Math.min(Number(r.playerVolume),1),0),r.playerSoundMuted=null!==r.playerSoundMuted&&r.playerSoundMuted,r.videoQuality=null!==r.videoQuality?r.videoQuality:"Auto",r.videoPlaybackSpeed=null!==r.videoPlaybackSpeed&&r.videoPlaybackSpeed,r.inTheaterMode=null!==r.inTheaterMode&&r.inTheaterMode,(0,a.useEffect)((function(){return e.inEmbed||document.hasFocus()||"visible"===document.visibilityState?c():(window.addEventListener("focus",c),document.addEventListener("visibilitychange",c)),function(){null!==n&&(videojs(t.current).dispose(),n=null),void 0!==e.onUnmountCallback&&e.onUnmountCallback()}}),[]),null===e.errorMessage?a.createElement("video",{ref:t,className:"video-js vjs-mediacms native-dimensions"}):a.createElement("div",{className:"error-container"},a.createElement("div",{className:"error-container-inner"},a.createElement("span",{className:"icon-wrap"},a.createElement("i",{className:"material-icons"},"error_outline")),a.createElement("span",{className:"msg-wrap"},e.errorMessage)))}c.propTypes={errorMessage:i().string.isRequired},d.propTypes={playerVolume:i().string,playerSoundMuted:i().bool,videoQuality:i().string,videoPlaybackSpeed:i().number,inTheaterMode:i().bool,siteId:i().string.isRequired,siteUrl:i().string.isRequired,errorMessage:i().string,cornerLayers:i().object,subtitlesInfo:i().array.isRequired,inEmbed:i().bool.isRequired,sources:i().array.isRequired,info:i().object.isRequired,enableAutoplay:i().bool.isRequired,hasTheaterMode:i().bool.isRequired,hasNextLink:i().bool.isRequired,hasPreviousLink:i().bool.isRequired,poster:i().string,previewSprite:i().object,onClickPreviousCallback:i().func,onClickNextCallback:i().func,onPlayerInitCallback:i().func,onStateUpdateCallback:i().func,onUnmountCallback:i().func},d.defaultProps={errorMessage:null,cornerLayers:{}}},160:function(e,t,n){n.d(t,{R:function(){return h}}),n(2322),n(9268),n(9751),n(2004),n(8407),n(6394),n(8288),n(5677),n(2129),n(4655),n(288),n(4458),n(3675);var a=n(5466),r=n(3074),i=n.n(r),o=n(137),l=n.n(o),s=n(3613),u=n(473),c=n(9722),d=n(9905),p=n(8727),m=n(1283);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);o=!0);}catch(e){l=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function h(e){var t=(0,a.useContext)(s.ApiUrlContext),n=(0,a.useContext)(s.SiteContext),r=f((0,a.useState)(null),2),i=(r[0],r[1]),o=f((0,a.useState)(null),2),y=o[0],h=o[1],g=f((0,a.useState)(null),2),v=g[0],b=g[1],S=f((0,a.useState)([]),2),w=S[0],P=S[1],E=f((0,a.useState)({}),2),M=E[0],_=E[1],k=f((0,a.useState)([]),2),C=k[0],A=k[1],N=f((0,a.useState)({}),2),O=N[0],x=N[1],I={videoQuality:new c.BrowserCache(n.id,86400).get("video-quality")};I.videoQuality=null!==I.videoQuality?I.videoQuality:"Auto";var V,R=null,L=null,T=null,j=((V=new(l())(e.pageLink).query)?((V=V.substring(1)).split("&"),V=V.length?V.split("="):[]):V=[],V);if(j.length)for(var D=0;D<j.length;)"m"===j[D]&&(T=j[D+1]),D+=2;function U(e){if(void 0!==e&&e&&void 0!==e.data&&e.data){var t,a;L=e.data;var r=[],o=null,l=(0,d.RA)(L.encodings_info,L.hls_info),s=null,c=null;if("string"==typeof L.poster_url?o=(0,u.formatInnerLink)(L.poster_url,n.url):"string"==typeof L.thumbnail_url&&(o=(0,u.formatInnerLink)(L.thumbnail_url,n.url)),Object.keys(l).length){var p=(0,d.KC)(),f=I.videoQuality;(null===f||"Auto"===f&&void 0===l.Auto)&&(f=720);var y=(0,d.$e)(f,l);for("Auto"===f&&void 0!==l.Auto&&r.push({src:l.Auto.url[0]}),a=0;a<l[y].format.length;){if("hls"===l[y].format[a]){r.push({src:l[y].url[a]});break}a+=1}for(a in L.encodings_info[y])L.encodings_info[y].hasOwnProperty(a)&&p.support[a]&&(t=L.encodings_info[y][a].url)&&(t=(0,u.formatInnerLink)(t,n.url),r.push({src:t,encodings_status:L.encodings_info[y][a].status}))}else l=null;if(1===r.length&&"running"===r[0].encodings_status&&(s="encodingRunning",c="Media encoding is currently running. Try again in few minutes."),null!==s)switch(s){case"encodingRunning":case"encodingPending":case"encodingFailed":break;default:m.warn("VIDEO DEBUG:","Video files don't exist")}i(s),h(c),b(o),P(r),_(l),A(L.subtitles_info),x(L.sprites_url?{url:(0,u.formatInnerLink)(L.sprites_url,n.url),frame:{width:160,height:90,seconds:10}}:null);var g=document.querySelector(".feat-first-item .item .item-description > div");g&&(g.innerHTML=L.summary)}}function q(e){if(void 0!==e&&void 0!==e.type)switch(e.type){case"network":case"private":case"unavailable":i(e.type),h(void 0!==e.message?e.message:"n error occurred while loading the media's data")}}return null!==T&&(R=t.media+"/"+T),(0,a.useEffect)((function(){null!==R&&(0,u.getRequest)(R,!1,U,q)}),[]),w.length?a.createElement("div",{className:"video-player"},a.createElement(p.Y7,{siteId:n.id,siteUrl:n.url,info:M,sources:w,poster:v,previewSprite:O,subtitlesInfo:C,enableAutoplay:!1,inEmbed:!1,hasTheaterMode:!1,hasNextLink:!1,hasPreviousLink:!1,errorMessage:y})):null}h.propTypes={pageLink:i().string.isRequired}},8204:function(e,t,n){n.d(t,{T:function(){return p}}),n(5101),n(3080),n(2004),n(8407),n(6394),n(8288),n(5677),n(2129),n(4655);var a=n(5466),r=n(541),i=n(6191),o=n(4234);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(f,e);var t,n,l,p,m=(l=f,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(l);if(p){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return c(this,e)});function f(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),n=m.call(this,e),void 0!==t&&r.PageActions.initPage(t),n}return t=f,(n=[{key:"render",value:function(){return a.createElement(a.Fragment,null,a.createElement(i.PageMain,null,this.pageContent()),a.createElement(o.Notifications,null))}}])&&s(t.prototype,n),f}(a.PureComponent)},1450:function(e,t,n){function a(){var e,t,n,a=null;if(document.cookie&&""!==document.cookie)for(t=document.cookie.split(";"),e=0;e<t.length;){if("csrftoken="===(n=t[e].trim()).substring(0,10)){a=decodeURIComponent(n.substring(10));break}e+=1}return a}n.d(t,{o:function(){return a}}),n(2322),n(9268),n(3233)},1397:function(e,t,n){n.d(t,{U:function(){return i}}),n(2322),n(3296),n(6394),n(4669);var a=n(137),r=n.n(a);function i(e,t){var n=r()(e,{});return""!==n.origin&&"null"!==n.origin&&n.origin||(n=r()(t+"/"+e.replace(/^\//g,""),{})),n.toString()}},447:function(e,t,n){n.d(t,{A_:function(){return l},j0:function(){return u},GH:function(){return d},Jl:function(){return m}}),n(7588),n(6394),n(5334);var a=n(4559),r=n.n(a);function i(e,t,n,a,r,i,o){try{var l=e[i](o),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(a,r)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function l(e){i(o,a,r,l,s,"next",e)}function s(e){i(o,a,r,l,s,"throw",e)}l(void 0)}))}}function l(e,t,n,a){return s.apply(this,arguments)}function s(){return(s=o(regeneratorRuntime.mark((function e(t,n,r,i){var o,l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=function(e){if(i instanceof Function){var t=e;if(void 0===e.response)t={type:"network",error:e};else if(void 0!==e.response.status)switch(e.response.status){case 401:t={type:"private",error:e,message:"Media is private"};break;case 400:t={type:"unavailable",error:e,message:"Media is unavailable"}}i(t)}},l=function(e){r instanceof Function&&r(e)},o={timeout:null,maxContentLength:null},!n){e.next=8;break}return e.next=6,(0,a.get)(t,o).then(l).catch(s||null);case 6:e.next=9;break;case 8:(0,a.get)(t,o).then(l).catch(s||null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e,t,n,a,r,i){return c.apply(this,arguments)}function c(){return(c=o(regeneratorRuntime.mark((function e(t,n,r,i,o,l){var s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=function(e){l instanceof Function&&l(e)},s=function(e){o instanceof Function&&o(e)},n=n||{},!i){e.next=8;break}return e.next=6,(0,a.post)(t,n,r||null).then(s).catch(u||null);case 6:e.next=9;break;case 8:(0,a.post)(t,n,r||null).then(s).catch(u||null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,t,n,a,r,i){return p.apply(this,arguments)}function p(){return(p=o(regeneratorRuntime.mark((function e(t,n,r,i,o,l){var s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=function(e){l instanceof Function&&l(e)},s=function(e){o instanceof Function&&o(e)},n=n||{},!i){e.next=8;break}return e.next=6,(0,a.put)(t,n,r||null).then(s).catch(u||null);case 6:e.next=9;break;case 8:(0,a.put)(t,n,r||null).then(s).catch(u||null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t,n,a,r){return f.apply(this,arguments)}function f(){return(f=o(regeneratorRuntime.mark((function e(t,n,a,i,o){var l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=function(e){o instanceof Function&&o(e)},l=function(e){i instanceof Function&&i(e)},n=n||{},!a){e.next=8;break}return e.next=6,r().delete(t,n||null).then(l).catch(s||null);case 6:e.next=9;break;case 8:r().delete(t,n||null).then(l).catch(s||null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},541:function(e,t,n){var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoViewerActions=t.SearchFieldActions=t.ProfilePageActions=t.PlaylistViewActions=t.PlaylistPageActions=t.PageActions=t.MediaPageActions=void 0,t.MediaPageActions=i(n(979)),t.PageActions=i(n(6613)),t.PlaylistPageActions=i(n(5880)),t.PlaylistViewActions=i(n(9660)),t.ProfilePageActions=i(n(2472)),t.SearchFieldActions=i(n(2600)),t.VideoViewerActions=i(n(5464))},8578:function(e,t,n){var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoViewerStore=t.SearchFieldStore=t.ProfilePageStore=t.PlaylistViewStore=t.PlaylistPageStore=t.PageStore=t.MediaPageStore=void 0;var r=a(n(337));t.MediaPageStore=r.default;var i=a(n(7959));t.PageStore=i.default;var o=a(n(1566));t.PlaylistPageStore=o.default;var l=a(n(1439));t.PlaylistViewStore=l.default;var s=a(n(8024));t.ProfilePageStore=s.default;var u=a(n(7359));t.SearchFieldStore=u.default;var c=a(n(5641));t.VideoViewerStore=c.default}},n={};function a(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,a),i.exports}a.m=t,e=[],a.O=function(t,n,r,i){if(!n){var o=1/0;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],i=e[u][2];for(var l=!0,s=0;s<n.length;s++)(!1&i||o>=i)&&Object.keys(a.O).every((function(e){return a.O[e](n[s])}))?n.splice(s--,1):(l=!1,i<o&&(o=i));l&&(e.splice(u--,1),t=r())}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,r,i]},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,{a:t}),t},a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.j=411,function(){var e={411:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,i,o=n[0],l=n[1],s=n[2],u=0;for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(s)var c=s(a);for(t&&t(n);u<o.length;u++)i=o[u],a.o(e,i)&&e[i]&&e[i][0](),e[o[u]]=0;return a.O(c)},n=self.webpackChunkmediacms_frontend=self.webpackChunkmediacms_frontend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=a.O(void 0,[431],(function(){return a(9820)}));r=a.O(r)}();